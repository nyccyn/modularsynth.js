(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{50:function(e,t,n){e.exports=n(84)},55:function(e,t,n){},63:function(e,t,n){},65:function(e,t,n){e.exports=n.p+"static/media/port.1b33f6c1.svg"},66:function(e,t,n){e.exports=n.p+"static/media/knob.23f417df.svg"},67:function(e,t,n){var o={"./pulse.svg":68,"./sawtooth.svg":69,"./sine.svg":70,"./triangle.svg":71};function a(e){var t=r(e);return n(t)}function r(e){var t=o[e];if(!(t+1)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return t}a.keys=function(){return Object.keys(o)},a.resolve=r,e.exports=a,a.id=67},68:function(e,t,n){e.exports=n.p+"static/media/pulse.f9689bc2.svg"},69:function(e,t,n){e.exports=n.p+"static/media/sawtooth.de511017.svg"},70:function(e,t,n){e.exports=n.p+"static/media/sine.e1994103.svg"},71:function(e,t,n){e.exports=n.p+"static/media/triangle.87d20148.svg"},77:function(e,t,n){},79:function(e,t,n){},81:function(e,t,n){e.exports=n.p+"static/media/screw_header.2c2805d6.svg"},82:function(e,t,n){},84:function(e,t,n){"use strict";n.r(t);var o=n(0),a=n.n(o),r=n(43),c=n.n(r),i=(n(55),n(9)),u=n(10),l=n(12),d=n(11),s=n(13),p=n(6),h=n(27),f=n(46),m=n(7),v=n(99),b=n(28),O=n(72),y=n(40),g=n(2),C=n(3),I=n(85),E=n(103),j=n(25),w=function(e,t){return{type:"ADD_MODULE",moduleType:e,id:t}},_=function(e){return{type:"CONNECT_MODULES",output:e.output,input:e.input}},M=function(e,t){return{type:"REGISTER_INPUTS",id:e,inputs:t}},T=function(e,t){return{type:"REGISTER_OUTPUTS",id:e,outputs:t}},A=function(){return{type:"UNSET_STARTING_PORT"}},P=function(e){return{type:"ADD_CABLE",portId:e.portId,fromPoint:e.fromPoint,color:e.color}},x=function(e){return{type:"MODIFY_CABLE",portId:e.portId,toPoint:e.toPoint,toPortId:e.toPortId}},D=function(e){return{type:"REMOVE_CABLE",portId:e}},k=n(48),S=n.n(k),R=n(34),N=n.n(R),V=(n(63),"ABOVE"),F="BELOW",U=Object(p.b)(function(e,t){var n=e.modules;return{startingPort:n.startingPort,connections:n.connections[t.moduleId]}},{connectModules:_,disconnectModule:function(e){return{type:"DISCONNECT_MODULE",port:e}},setStartingPort:function(e){return{type:"SET_STARTING_PORT",port:e}},unsetStartingPort:A,addCable:P,removeCable:D,modifyCable:x})(function(e){var t,o=e.label,r=e.labelPosition,c=void 0===r?V:r,i=e.portId,u=e.connections,l=e.connectModules,d=e.disconnectModule,s=e.moduleId,p=e.portType,h=e.startingPort,f=e.setStartingPort,v=e.unsetStartingPort,b=e.addCable,O=e.removeCable,y=e.modifyCable,g=o||i;return a.a.createElement("div",{className:S()("port",{disabled:h&&h.portType===p}),onMouseDown:function(e){e.stopPropagation();var n={portId:i,portType:p,moduleId:s};u[i]&&(d({moduleId:s,portId:i}),O("".concat(u[i].moduleId,"-").concat(u[i].portId))),f(n);var o=t.getBoundingClientRect(),a=o.x,r=o.y,c=o.width,l=o.height;b({portId:"".concat(s,"-").concat(i),fromPoint:{x:a+c/2,y:r+l/2},color:N()({luminosity:"dark"})})},onMouseUp:function(e){var n;if(v(),h&&h.portType!==p&&(h.moduleId!==s||h.id!==i)){e.stopPropagation();var o=t.getBoundingClientRect(),a=o.x,r=o.y,c=o.width,d=o.height;!u[i]||u[i].moduleId===h.moduleId&&u[i].portId===h.portId||(O("".concat(u[i].moduleId,"-").concat(u[i].portId)),O("".concat(s,"-").concat(i))),y({portId:"".concat(h.moduleId,"-").concat(h.portId),toPoint:{x:a+c/2,y:r+d/2},toPortId:"".concat(s,"-").concat(i)}),l((n={},Object(m.a)(n,h.portType,h),Object(m.a)(n,p,{moduleId:s,portId:i}),n))}}},c===V&&g,a.a.createElement("img",{id:"".concat(s,"-").concat(i),height:"30",width:"30",ref:function(e){return t=e},onMouseDown:function(e){return e.preventDefault()},src:n(65),alt:"".concat(s,"-").concat(i)}),c===F&&g)}),q=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).handleMouseMove=n.handleMouseMove.bind(Object(g.a)(Object(g.a)(n))),n.handleMouseDown=n.handleMouseDown.bind(Object(g.a)(Object(g.a)(n))),n.handleMouseUp=n.handleMouseUp.bind(Object(g.a)(Object(g.a)(n))),n.calculateValueAngle=n.calculateValueAngle.bind(Object(g.a)(Object(g.a)(n))),n}return Object(s.a)(t,e),Object(u.a)(t,[{key:"componentWillMount",value:function(){document.addEventListener("mouseup",this.handleMouseUp),document.addEventListener("mousemove",this.handleMouseMove)}},{key:"handleMouseMove",value:function(e){var t=this.props,n=t.isMoving,o=t.onChange,a=t.max,r=t.min,c=t.step;if(n&&(e.stopPropagation(),e.preventDefault(),1===e.buttons)){var i=this._elem.getBoundingClientRect(),u=i.x,l=i.y,d=u+i.width/2,s=l+i.height/2,p=e.clientX-d,h=e.clientY-s,f=180*Math.atan2(h,p)/Math.PI;f<0&&(f+=360),(f-=120)<0&&(f+=360),f>315&&(f=0);var m=f/300*(a-r)+r;(m=Math.floor(m/c)*c)>a&&(m=a),o(m)}}},{key:"handleMouseDown",value:function(e){e.stopPropagation(),this.props.setIsMoving(!0)}},{key:"handleMouseUp",value:function(){this.props.setIsMoving(!1)}},{key:"calculateValueAngle",value:function(){var e=this.props,t=e.min,n=e.max;return 2*((e.value-t)/(n-t))*150}},{key:"render",value:function(){var e=this,t=this.props,o=t.label,r=t.height,c=void 0===r?50:r,i=t.width,u=void 0===i?50:i;return a.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},o,a.a.createElement("img",{ref:function(t){e._elem=t},style:{cursor:"pointer",margin:"auto",transform:"rotate(".concat(this.calculateValueAngle(),"deg)")},onMouseDown:this.handleMouseDown,alt:"knob",src:n(66),height:c,width:u}))}}]),t}(o.Component),G=Object(C.a)(Object(C.c)("isMoving","setIsMoving",!1))(q),B={container:{display:"flex",flexDirection:"column",height:"100%"},body:{display:"flex",flexDirection:"column",flex:1,justifyContent:"space-evenly"},spaceAround:{display:"flex",justifyContent:"space-around"}},L=function(e,t){var n=e.createOscillator();return n.type=t,n.frequency.value=0,n},W=function(e){function t(e){var n;Object(i.a)(this,t),n=Object(l.a)(this,Object(d.a)(t).call(this,e));var o=e.audioContext;if(!o)throw new Error("audioContext property must be provided");var a=o.createPulseOscillator();return a.frequency.value=0,a.width.value=0,n._oscillators={Sawtooth:L(o,"sawtooth"),Pulse:a,Triangle:L(o,"triangle"),Sine:L(o,"sine")},window.pulse=n._oscillators.Pulse,window["sine"+e.id]=n._oscillators.Sine,n._frequencyControl=o.createVoltToHzConverter(440,2),n._detuneControl=o.createConstantSource(),n._frequencyControl.volt.value=0,n._detuneControl.offset.value=0,n._fmGain=o.createGain(),n._fmGain.gain.value=0,n._fmGain.connect(n._frequencyControl.volt),I.a(function(e){return n._frequencyControl.connect(e.frequency)})(n._oscillators),I.a(function(e){return n._detuneControl.connect(e.detune)})(n._oscillators),n._pwCvGain=o.createGain(),n._pwCvGain.gain.value=0,n._pwCvGain.connect(n._oscillators.Pulse.width),window.pwm=n._pwCvGain,n.handleFrequencyChange=n.handleFrequencyChange.bind(Object(g.a)(Object(g.a)(n))),n.handleTuneChange=n.handleTuneChange.bind(Object(g.a)(Object(g.a)(n))),n.handlePwChange=n.handlePwChange.bind(Object(g.a)(Object(g.a)(n))),n.handlePwmCvChange=n.handlePwmCvChange.bind(Object(g.a)(Object(g.a)(n))),n.handleFmCvChange=n.handleFmCvChange.bind(Object(g.a)(Object(g.a)(n))),n}return Object(s.a)(t,e),Object(u.a)(t,[{key:"componentWillMount",value:function(){var e=this,t=this.props,n=t.id,o=t.registerInputs,a=t.registerOutputs;this.startNodes(),o(n,{"V/Oct":{connect:function(t){return t.connect(e._frequencyControl.volt)},disconnect:function(t){return t.disconnect(e._frequencyControl.volt)}},PWM:{connect:function(t){return t.connect(e._pwCvGain)},disconnect:function(t){return t.disconnect(e._pwCvGain)}},FM:{connect:function(t){return t.connect(e._fmGain)},disconnect:function(t){return t.disconnect(e._fmGain)}}}),a(n,{Sawtooth:this._oscillators.Sawtooth,Pulse:this._oscillators.Pulse,Triangle:this._oscillators.Triangle,Sine:this._oscillators.Sine})}},{key:"handleFrequencyChange",value:function(e){this.props.setFrequency(e),this._frequencyControl.offset.value=e}},{key:"handleTuneChange",value:function(e){this.props.setTune(e),this._detuneControl.offset.value=e}},{key:"handlePwChange",value:function(e){this.props.setPw(e),this._oscillators.Pulse.width.value=e}},{key:"handlePwmCvChange",value:function(e){this.props.setPwmCv(e),this._pwCvGain.gain.value=e/10}},{key:"handleFmCvChange",value:function(e){this.props.setFmCv(e),this._fmGain.gain.value=e}},{key:"startNodes",value:function(){I.a(function(e){return e.start()})(this._oscillators),this._frequencyControl.start(),this._detuneControl.start()}},{key:"render",value:function(){var e=this.props,t=e.id,o=e.frequency,r=e.tune,c=e.pw,i=e.pwmCv,u=e.fmCv;return a.a.createElement("div",{style:B.container},a.a.createElement("span",null,"VCO"),a.a.createElement("div",{style:Object(y.a)({},B.body,{justifyContent:"space-between"})},a.a.createElement("div",{style:B.spaceAround},a.a.createElement("div",{style:Object(y.a)({},B.spaceAround,{flexDirection:"column"})},a.a.createElement(U,{portId:"V/Oct",moduleId:t,portType:"input"}),a.a.createElement(U,{portId:"FM",moduleId:t,portType:"input"}),a.a.createElement(U,{portId:"PWM",moduleId:t,portType:"input"})),a.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},a.a.createElement(G,{label:"Range",min:-2,max:2,step:.001,value:o,width:30,height:30,onChange:this.handleFrequencyChange}),a.a.createElement(G,{label:"Tune",min:-600,max:600,step:1,value:r,width:30,height:30,onChange:this.handleTuneChange}),a.a.createElement(G,{label:"FM CV",min:0,max:1,step:.005,value:u,width:30,height:30,onChange:this.handleFmCvChange}),a.a.createElement(G,{label:"PW",min:-1,max:1,step:.001,value:c,width:30,height:30,onChange:this.handlePwChange}),a.a.createElement(G,{label:"PWM CV",min:0,max:1,step:.005,value:i,width:30,height:30,onChange:this.handlePwmCvChange}))),a.a.createElement("div",{style:B.spaceAround},E.a(j.a,b.a(function(e){return a.a.createElement(U,{key:e,label:a.a.createElement("img",{width:25,src:n(67)("./".concat(e.toLowerCase(),".svg")),alt:e}),labelPosition:F,portId:e,moduleId:t,portType:"output"})}))(this._oscillators))))}}]),t}(o.Component),K=Object(C.a)(Object(C.b)("isBrowserSupported","undefined"!==typeof OscillatorNode&&"undefined"!==typeof ConstantSourceNode),Object(C.b)("panelWidth",8),Object(C.c)("frequency","setFrequency",0),Object(C.c)("tune","setTune",0),Object(C.c)("pw","setPw",0),Object(C.c)("pwmCv","setPwmCv",0),Object(C.c)("fmCv","setFmCv",0),Object(C.c)("vOct","setVOct",0),Object(p.b)(null,{connectModules:_,registerInputs:M,registerOutputs:T}))(W),Y=function(e){function t(e){var n;if(Object(i.a)(this,t),n=Object(l.a)(this,Object(d.a)(t).call(this,e)),!e.audioContext)throw new Error("audioContext property must be provided");return n._leftPanner=new StereoPannerNode(e.audioContext,{pan:-1}),n._rightPanner=new StereoPannerNode(e.audioContext,{pan:1}),n._leftPanner.connect(e.audioContext.destination),n._rightPanner.connect(e.audioContext.destination),n}return Object(s.a)(t,e),Object(u.a)(t,[{key:"componentWillMount",value:function(){var e=this,t=this.props,n=t.id;(0,t.registerInputs)(n,{Left:{connect:function(t){return t.connect(e._leftPanner)},disconnect:function(t){return t.disconnect(e._leftPanner)}},Right:{connect:function(t){return t.connect(e._rightPanner)},disconnect:function(t){return t.disconnect(e._rightPanner)}}})}},{key:"render",value:function(){var e=this.props,t=e.id,n=e.connections;return a.a.createElement("div",{style:B.container},a.a.createElement("span",null,"Stereo"),a.a.createElement("div",{style:B.body},a.a.createElement(U,{portId:"Left",connections:n,moduleId:t,portType:"input"}),a.a.createElement(U,{portId:"Right",connections:n,moduleId:t,portType:"input"})))}}]),t}(o.Component),Q=Object(C.a)(Object(C.b)("isBrowserSupported","undefined"!==typeof StereoPannerNode),Object(C.b)("panelWidth",4),Object(p.b)(function(e,t){return{connections:e.modules.connections[t.id]}},{connectModules:_,registerInputs:M}))(Y),z=function(e){function t(e){var n;if(Object(i.a)(this,t),n=Object(l.a)(this,Object(d.a)(t).call(this,e)),!e.audioContext)throw new Error("audioContext property must be provided");return n}return Object(s.a)(t,e),Object(u.a)(t,[{key:"componentWillMount",value:function(){var e=this,t=this.props,n=t.id;(0,t.registerInputs)(n,{In:{connect:function(t){return t.connect(e.props.audioContext.destination)},disconnect:function(t){return t.disconnect(e.props.audioContext.destination)}}})}},{key:"render",value:function(){var e=this.props,t=e.id,n=e.connections;return a.a.createElement("div",{style:B.container},a.a.createElement("span",null,"Mono"),a.a.createElement("div",{style:B.body},a.a.createElement(U,{portId:"In",connections:n,moduleId:t,portType:"input"})))}}]),t}(o.Component),H=Object(C.a)(Object(C.b)("isBrowserSupported",!0),Object(C.b)("panelWidth",4),Object(p.b)(function(e,t){return{connections:e.modules.connections[t.id]}},{connectModules:_,registerInputs:M}))(z),X=n(106),J=[90,83,88,68,67,86,71,66,72,78,74,77,188],$=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B","C"],Z={"C#":"1/4","D#":"3/6","F#":"6/9","G#":"8/11","A#":"10/13"},ee=function(e,t){return t-5+(e+3)/12},te=function(e){function t(e){var n;if(Object(i.a)(this,t),n=Object(l.a)(this,Object(d.a)(t).call(this,e)),!e.audioContext)throw new Error("audioContext property must be provided");return n._gate=e.audioContext.createConstantSource(),n._gate.offset.value=0,n._gate.start(),n._cv=e.audioContext.createConstantSource(),n._cv.offset.value=0,n._cv.start(),n.handleKeyDown=n.handleKeyDown.bind(Object(g.a)(Object(g.a)(n))),n.handleKeyUp=n.handleKeyUp.bind(Object(g.a)(Object(g.a)(n))),n.handleOctaveChange=n.handleOctaveChange.bind(Object(g.a)(Object(g.a)(n))),n.handleKeyboardDown=n.handleKeyboardDown.bind(Object(g.a)(Object(g.a)(n))),n.handleKeyboardUp=n.handleKeyboardUp.bind(Object(g.a)(Object(g.a)(n))),n._keyboardDown=!1,n}return Object(s.a)(t,e),Object(u.a)(t,[{key:"componentWillMount",value:function(){var e=this.props,t=e.id;(0,e.registerOutputs)(t,{CV:this._cv,Gate:this._gate}),document.addEventListener("keydown",this.handleKeyboardDown),document.addEventListener("keyup",this.handleKeyboardUp)}},{key:"handleKeyboardDown",value:function(e){var t=X.a(e.keyCode,J);this._keyboardDown||-1===t||(this._keyboardDown=!0,this.handleKeyDown(ee(t,this.props.octave)))}},{key:"handleKeyboardUp",value:function(){this._keyboardDown=!1,this.handleKeyUp()}},{key:"handleKeyDown",value:function(e){this.changeFrequency(e),this._gate.offset.value=1}},{key:"handleKeyUp",value:function(){this._gate.offset.value=0}},{key:"handleOctaveChange",value:function(e){var t=e.target.value,n=this.props,o=n.setOctave,a=n.octave,r=Number(t),c=this._cv.offset.value;this.changeFrequency(c+r-a),o(r)}},{key:"changeFrequency",value:function(e){this._cv.offset.value=e}},{key:"render",value:function(){var e=this,t=this.props,n=t.id,o=t.connections,r=t.octave;return a.a.createElement("div",{style:B.container},a.a.createElement("span",null,"\xb5Keyboard"),a.a.createElement("div",{style:B.body},"Octave",a.a.createElement("select",{value:r,onChange:this.handleOctaveChange},a.a.createElement("option",{value:2},"-2"),a.a.createElement("option",{value:3},"-1"),a.a.createElement("option",{value:4},"0"),a.a.createElement("option",{value:5},"+1"),a.a.createElement("option",{value:6},"+2")),a.a.createElement("div",{style:{display:"grid",flex:1}},$.map(function(t,n){var o=t.endsWith("#"),c=o?Z[t]:n+1;return[a.a.createElement("div",{key:"TITLE_".concat(t).concat(n),style:{alignSelf:"center",gridRow:c,gridColumn:o?4:1}},t),a.a.createElement("button",{key:"".concat(t).concat(n),onMouseDown:function(t){t.stopPropagation(),e.handleKeyDown(ee(n,r))},onMouseUp:e.handleKeyUp,style:{height:20,width:20,gridRow:c,alignSelf:"center",gridColumn:o?3:2,backgroundColor:o?"black":"white"}})]})),a.a.createElement("div",{style:B.spaceAround},a.a.createElement(U,{portId:"CV",connections:o,moduleId:n,portType:"output"}),a.a.createElement(U,{portId:"Gate",connections:o,moduleId:n,portType:"output"}))))}}]),t}(o.Component),ne=Object(C.a)(Object(C.b)("isBrowserSupported","undefined"!==typeof ConstantSourceNode),Object(C.b)("panelWidth",6),Object(C.c)("octave","setOctave",4),Object(p.b)(function(e,t){return{connections:e.modules.connections[t.id]}},{connectModules:_,registerOutputs:T}))(te);for(var oe,ae,re=function(e){return 15*Math.pow(e,4)+.001},ce=function(e){function t(e){var n;if(Object(i.a)(this,t),n=Object(l.a)(this,Object(d.a)(t).call(this,e)),!e.audioContext)throw new Error("audioContext property must be provided");return n._adsr=e.audioContext.createConstantSource(),n._adsr.offset.value=0,n.handleGateInChange=n.handleGateInChange.bind(Object(g.a)(Object(g.a)(n))),n}return Object(s.a)(t,e),Object(u.a)(t,[{key:"componentWillMount",value:function(){var e=this,t=this.props,n=t.id,o=t.registerInputs,a=t.registerOutputs;this._adsr.start(),o(n,{Gate:{connect:function(t){return e._gateInterval=function(e,t){var n=null,o=function(o){if(e[o]instanceof AudioParam){var a=e[o].value;return t(a),n=setInterval(function(){a!==e[o].value&&(a=e[o].value,t(a))},0),"break"}};for(var a in e)if("break"===o(a))break;return n}(t,e.handleGateInChange)},disconnect:function(){e._gateInterval&&(clearInterval(e._gateInterval),e._gateInterval=null)}}}),a(n,{Out:this._adsr})}},{key:"handleGateInChange",value:function(e){var t=this.props,n=t.sustain,o=t.audioContext,a=re(this.props.attack),r=re(this.props.decay),c=re(this.props.release),i=o.currentTime,u=this._adsr.offset;1===e?(u.cancelScheduledValues(0),u.linearRampToValueAtTime(0,i+.01),u.linearRampToValueAtTime(1,i+a),u.linearRampToValueAtTime(n,i+a+r)):0===e&&(u.cancelScheduledValues(0),u.setValueAtTime(u.value,i),u.linearRampToValueAtTime(0,i+c))}},{key:"render",value:function(){var e=this.props,t=e.id,n=e.connections,o=e.attack,r=e.setAttack,c=e.decay,i=e.setDecay,u=e.sustain,l=e.setSustain,d=e.release,s=e.setRelease;return a.a.createElement("div",{style:B.container},a.a.createElement("span",null,"ADSR"),a.a.createElement("div",{style:B.body},"Attack:",a.a.createElement(G,{min:0,max:1,step:.001,value:o,onChange:function(e){return r(e)},width:30,height:30}),"Decay:",a.a.createElement(G,{min:0,max:1,step:.001,value:c,onChange:function(e){return i(e)},width:30,height:30}),"Sustain:",a.a.createElement(G,{min:0,max:1,step:.01,value:u,onChange:function(e){return l(Number(e))},width:30,height:30}),"Release:",a.a.createElement(G,{min:0,max:1,step:.001,value:d,onChange:function(e){return s(Number(e))},width:30,height:30}),a.a.createElement("div",{style:B.spaceAround},a.a.createElement(U,{portId:"Gate",connections:n,moduleId:t,portType:"input"}),a.a.createElement(U,{portId:"Out",connections:n,moduleId:t,portType:"output"}))))}}]),t}(o.Component),ie=Object(C.a)(Object(C.b)("isBrowserSupported","undefined"!==typeof ConstantSourceNode),Object(C.b)("panelWidth",6),Object(C.c)("attack","setAttack",.5),Object(C.c)("decay","setDecay",.5),Object(C.c)("sustain","setSustain",.5),Object(C.c)("release","setRelease",.5),Object(p.b)(function(e,t){return{connections:e.modules.connections[t.id]}},{connectModules:_,registerInputs:M,registerOutputs:T}))(ce),ue=function(e){function t(e){var n;if(Object(i.a)(this,t),n=Object(l.a)(this,Object(d.a)(t).call(this,e)),!e.audioContext)throw new Error("audioContext property must be provided");return n._gain=e.audioContext.createGain(),n}return Object(s.a)(t,e),Object(u.a)(t,[{key:"componentWillMount",value:function(){var e=this,t=this.props,n=t.id,o=t.registerInputs,a=t.registerOutputs,r=t.audioContext;o(n,{In:{connect:function(t){return t.connect(e._gain)},disconnect:function(t){return t.disconnect(e._gain)}},CV:{connect:function(t){e._gain.gain.linearRampToValueAtTime(0,r.currentTime+.01),t.connect(e._gain.gain)},disconnect:function(t){e._gain.gain.linearRampToValueAtTime(1,r.currentTime+.01),t.disconnect(e._gain.gain),t.offset&&(t.offset.value=0)}}}),a(n,{Out:this._gain})}},{key:"render",value:function(){var e=this.props,t=e.id,n=e.connections;return a.a.createElement("div",{style:B.container},a.a.createElement("span",null,"VCA"),a.a.createElement("div",{style:B.body},a.a.createElement(U,{portId:"In",connections:n,moduleId:t,portType:"input"}),a.a.createElement(U,{portId:"CV",connections:n,moduleId:t,portType:"input"}),a.a.createElement(U,{portId:"Out",connections:n,moduleId:t,portType:"output"})))}}]),t}(o.Component),le=Object(C.a)(Object(C.b)("isBrowserSupported","undefined"!==typeof GainNode),Object(C.b)("panelWidth",4),Object(p.b)(function(e,t){return{connections:e.modules.connections[t.id]}},{connectModules:_,registerInputs:M,registerOutputs:T}))(ue),de=function(e){function t(e){var n;if(Object(i.a)(this,t),n=Object(l.a)(this,Object(d.a)(t).call(this,e)),!e.audioContext)throw new Error("audioContext property must be provided");return n._vcf=e.audioContext.createBiquadFilter(),n._vcf.type="lowpass",n._vcf.Q.value=.5,n.handleFrequencyChange=n.handleFrequencyChange.bind(Object(g.a)(Object(g.a)(n))),n.handleTypeChange=n.handleTypeChange.bind(Object(g.a)(Object(g.a)(n))),n.setPitch=n.setPitch.bind(Object(g.a)(Object(g.a)(n))),n.handleQChange=n.handleQChange.bind(Object(g.a)(Object(g.a)(n))),n.setQuality=n.setQuality.bind(Object(g.a)(Object(g.a)(n))),n}return Object(s.a)(t,e),Object(u.a)(t,[{key:"componentWillMount",value:function(){var e=this,t=this.props,n=t.id,o=t.registerInputs,a=t.registerOutputs;o(n,{In:{connect:function(t){return t.connect(e._vcf)},disconnect:function(t){return t.disconnect(e._vcf)}}}),a(n,{Out:this._vcf})}},{key:"handleFrequencyChange",value:function(e){this.props.setFrequency(Number(e),this.setPitch)}},{key:"setPitch",value:function(){var e=this.props,t=e.frequency,n=e.audioContext,o=n.sampleRate/2,a=Math.log(o/40)/Math.LN2,r=Math.pow(2,a*(t-1));this._vcf.frequency.setValueAtTime(o*r,n.currentTime)}},{key:"handleQChange",value:function(e){this.props.setQ(Number(e),this.setQuality)}},{key:"handleTypeChange",value:function(e){var t=e.target.value;this.props.setType(t),this._vcf.type=t}},{key:"setQuality",value:function(){var e=this.props.q;this._vcf.Q.value=30*e}},{key:"render",value:function(){var e=this,t=this.props,n=t.id,o=t.connections,r=t.type,c=t.frequency,i=t.q;return a.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},a.a.createElement("span",null,"VCF"),"Shape:",a.a.createElement("select",{value:r,onChange:this.handleTypeChange},a.a.createElement("option",{value:"lowpass"},"Low Pass"),a.a.createElement("option",{value:"highpass"},"High Pass")),"Frequency:",a.a.createElement(G,{min:0,max:1,step:.01,value:c,onChange:function(t){return e.handleFrequencyChange(t)}}),"Q:",a.a.createElement(G,{min:0,max:1,step:.01,value:i,onChange:function(t){return e.handleQChange(t)}}),a.a.createElement(U,{portId:"In",connections:o,moduleId:n,portType:"input"}),a.a.createElement(U,{portId:"Out",connections:o,moduleId:n,portType:"output"}))}}]),t}(o.Component),se=Object(C.a)(Object(C.b)("isBrowserSupported","undefined"!==typeof BiquadFilterNode),Object(C.b)("panelWidth",6),Object(C.c)("type","setType","lowpass"),Object(C.c)("frequency","setFrequency",.1),Object(C.c)("q","setQ",.5),Object(p.b)(function(e,t){return{connections:e.modules.connections[t.id]}},{connectModules:_,registerInputs:M,registerOutputs:T}))(de),pe={VCO:"VCO",STEREO_AUDIO_INTERFACE:"STEREO_AUDIO_INTERFACE",MONO_AUDIO_INTERFACE:"MONO_AUDIO_INTERFACE",KEYBOARD:"KEYBOARD",ADSR:"ADSR",VCA:"VCA",VCF:"VCF"},he=b.a(O.a(1))(pe),fe=n(86),me=n(87),ve=n(88),be=n(101),Oe=n(89),ye=n(73),ge=n(100),Ce=n(90),Ie=n(75),Ee=n(91),je=n(74),we=n(92),_e=n(108),Me=n(76),Te=fe.a(function(e,t){var n=e.moduleId,o=e.portId;return me.a(ve.a(be.a(Oe.a),[n,o]),E.a(ye.a([n,o]),function(e){return ge.a([e.moduleId,e.portId],t)}))(t)}),Ae=Object(v.a)((oe={},Object(m.a)(oe,"ADD_MODULE",function(e,t){var n=t.moduleType,o=function(e){var t=e.type,n=e.id,o={id:(void 0===n?void 0:n)||"".concat(t).concat(he[t])};switch(t){case pe.VCO:o.Module=K;break;case pe.STEREO_AUDIO_INTERFACE:o.Module=Q;break;case pe.MONO_AUDIO_INTERFACE:o.Module=H;break;case pe.KEYBOARD:o.Module=ne;break;case pe.ADSR:o.Module=ie;break;case pe.VCF:o.Module=se;break;case pe.VCA:o.Module=le;break;default:throw new Error("Cannot create module of type: ".concat(t))}return o.Module.isBrowserSupported?(o.width=20*o.Module.panelWidth,he[t]++,o):null}({type:n,id:t.id});return o?(o.left=e.maxLeft,Ce.a({modules:Ie.a(o.id,o),connections:Ie.a(o.id,{}),maxLeft:Ee.a(o.width)})(e)):(window.alert("Your browser doesn't support this module: ".concat(n)),e)}),Object(m.a)(oe,"REGISTER_INPUTS",function(e,t){var n=t.id,o=t.inputs;return Ce.a({modules:Ce.a(Object(m.a)({},n,Ie.a("inputs",o)))})(e)}),Object(m.a)(oe,"REGISTER_OUTPUTS",function(e,t){var n=t.id,o=t.outputs;return Ce.a({modules:Ce.a(Object(m.a)({},n,Ie.a("outputs",o)))})(e)}),Object(m.a)(oe,"CONNECT_MODULES",function(e,t){var n,o=t.input,a=t.output;return Ce.a({connections:E.a(Te(a),Te(o),Ce.a((n={},Object(m.a)(n,o.moduleId,Ie.a(o.portId,{moduleId:a.moduleId,portId:a.portId})),Object(m.a)(n,a.moduleId,Ie.a(a.portId,{moduleId:o.moduleId,portId:o.portId})),n)))})(e)}),Object(m.a)(oe,"DISCONNECT_MODULE",function(e,t){var n=t.port;return Ce.a({connections:E.a(Te(n),Ce.a(Object(m.a)({},n.moduleId,je.a(n.portId))))})(e)}),Object(m.a)(oe,"SET_STARTING_PORT",function(e,t){var n=t.port;return Ce.a({startingPort:O.a(n)})(e)}),Object(m.a)(oe,"UNSET_STARTING_PORT",function(e){return Ce.a({startingPort:O.a(null)})(e)}),Object(m.a)(oe,"MOVE_MODULE",function(e,t){var n=t.moduleId,o=t.x,a=e.modules[n].left,r=e.modules[n].width,c=a+20*Math.floor((o-a)/20),i=c+r;return E.a(we.a,_e.a(function(e){var t=e.id,o=e.left,a=o+e.width;return t!==n&&(o>=c&&o<i||o<c&&a>c||o===c&&a===i)}))(e.modules)?e:Ce.a({modules:Ce.a(Object(m.a)({},n,Ce.a({left:O.a(c)}))),maxLeft:Me.a(c+e.modules[n].width)})(e)}),oe),{modules:{},connections:{},startingPort:null,maxLeft:20}),Pe=n(107),xe=n(93),De=n(94),ke=n(95),Se=n(102),Re=n(96),Ne=n(105),Ve=function(e){return Ce.a({x:Ee.a(e)})},Fe=Object(v.a)((ae={},Object(m.a)(ae,"ADD_CABLE",function(e,t){var n=t.portId,o=t.fromPoint,a=t.color;return Ce.a({cables:Ie.a(n,{portId:n,fromPoint:o,toPoint:o,color:a})})(e)}),Object(m.a)(ae,"MODIFY_CABLE",function(e,t){var n=t.portId,o=t.toPoint,a=t.toPortId;return Ce.a({cables:Ce.a(Object(m.a)({},n,Pe.a(xe.a,{toPoint:o,toPortId:a})))})(e)}),Object(m.a)(ae,"REMOVE_CABLE",function(e,t){var n=t.portId;return Ce.a({cables:je.a(n)})(e)}),Object(m.a)(ae,"MODIFY_MODULE_CABLES",function(e,t){var n=t.moduleId,o=t.diff;return Ce.a({cables:b.a(De.a([[ke.a({portId:Se.a(n)}),Ce.a({fromPoint:Ve(o)})],[ke.a({toPortId:Se.a(n)}),Ce.a({toPoint:Ve(o)})],[Re.a,Ne.a]]))})(e)}),ae),{cables:{}}),Ue=Object(h.c)({modules:Ae,cables:Fe}),qe=n(97),Ge=function(e){var t=e.getState;return function(e){return function(n){switch(n.type){case"CONNECT_MODULES":var o=t().modules,a=o.modules,r=o.connections,c=ye.a([n.input.moduleId,"inputs",n.input.portId])(a),i=ye.a([n.output.moduleId,"outputs",n.output.portId])(a);E.a(ye.a([n.output.moduleId,n.output.portId]),qe.a(Oe.a,E.a(function(e){var t=e.moduleId,n=e.portId;return ye.a([t,"inputs",n])(a)},function(e){return e.disconnect(i)})))(r),E.a(ye.a([n.input.moduleId,n.input.portId]),qe.a(Oe.a,E.a(function(e){var t=e.moduleId,n=e.portId;return ye.a([t,"outputs",n])(a)},function(e){return c.disconnect(e)})))(r),c&&i&&c.connect(i);break;case"DISCONNECT_MODULE":var u=t().modules,l=u.modules,d=u.connections,s=ye.a([n.port.moduleId,"inputs",n.port.portId])(l);if(s)E.a(ye.a([n.port.moduleId,n.port.portId]),function(e){var t=e.moduleId,n=e.portId;return ye.a([t,"outputs",n])(l)},function(e){return s.disconnect(e)})(d);else{var p=ye.a([n.port.moduleId,"outputs",n.port.portId])(l);E.a(ye.a([n.port.moduleId,n.port.portId]),function(e){var t=e.moduleId,n=e.portId;return ye.a([t,"inputs",n])(l)},function(e){return e.disconnect(p)})(d)}}return e(n)}}},Be=[f.a,Ge],Le=Object(h.d)(Ue,h.a.apply(void 0,Be)),We=n(104),Ke=n(39),Ye=Object(p.b)(null,{addModule:w})(function(e){var t=e.addModule;return a.a.createElement("div",null,a.a.createElement("button",{onClick:function(){return t(pe.KEYBOARD)}},"Add Keyboard"),a.a.createElement("button",{onClick:function(){return t(pe.VCO)}},"Add VCO"),a.a.createElement("button",{onClick:function(){return t(pe.VCA)}},"Add VCA"),a.a.createElement("button",{onClick:function(){return t(pe.ADSR)}},"Add ADSR"),a.a.createElement("button",{onClick:function(){return t(pe.VCF)}},"Add VCF"),a.a.createElement("button",{onClick:function(){return t(pe.STEREO_AUDIO_INTERFACE)}},"Add Stereo Audio Interface"),a.a.createElement("button",{onClick:function(){return t(pe.MONO_AUDIO_INTERFACE)}},"Add Mono Audio Interface"))}),Qe=function(e){var t=e.fromPoint,n=e.toPoint,o=e.color;return a.a.createElement("path",{d:"M".concat(t.x," ").concat(t.y," q ").concat(function(e,t){var n=e.y>t.y?e:t,o=e.y<t.y?e:t,a=.1*Math.abs(t.x-e.x)+Math.abs(e.y-t.y)/.4,r=.5+Math.log(1+Math.abs((t.y-e.y)/(t.x-e.x)))/(3*Math.log(2));r=n.x<o.x?1-r:r;var c=(e.x<t.x?1:-1)*r*Math.abs(e.x-t.x)||e.x;return"".concat(c," ").concat(a)}(t,n)," ").concat(n.x-t.x," ").concat(n.y-t.y),opacity:.6,stroke:o,fill:"transparent",strokeWidth:6})},ze=Object(p.b)(function(e){var t=e.cables;return{cables:we.a(t.cables)}},{})(function(e){var t=e.cables;return a.a.createElement("svg",{style:{position:"fixed",left:0,top:0,width:"100%",height:"100%",pointerEvents:"none"}},t.map(function(e){var t=e.portId,n=e.fromPoint,o=e.toPoint,r=e.color;return a.a.createElement(Qe,{key:t,fromPoint:n,toPoint:o,color:r})}))}),He={Basic:{modules:[{type:pe.KEYBOARD,id:"KEYBOARD1"},{type:pe.VCO,id:"VCO1"},{type:pe.ADSR,id:"ADSR1"},{type:pe.VCA,id:"VCA1"},{type:pe.MONO_AUDIO_INTERFACE,id:"MONO_AUDIO_INTERFACE1"}],connections:[{input:{moduleId:"VCO1",portId:"V/Oct"},output:{moduleId:"KEYBOARD1",portId:"CV"}},{input:{moduleId:"ADSR1",portId:"Gate"},output:{moduleId:"KEYBOARD1",portId:"Gate"}},{input:{moduleId:"VCA1",portId:"In"},output:{moduleId:"VCO1",portId:"Sine"}},{input:{moduleId:"VCA1",portId:"CV"},output:{moduleId:"ADSR1",portId:"Out"}},{input:{moduleId:"MONO_AUDIO_INTERFACE1",portId:"In"},output:{moduleId:"VCA1",portId:"Out"}}]}},Xe=n(98),Je=fe.a(function(e,t,n){var o=n.input,a=n.output;e(_(n));var r="".concat(o.moduleId,"-").concat(o.portId),c=document.getElementById(r).getBoundingClientRect();e(P({portId:r,color:N()({luminosity:"dark"}),fromPoint:{x:c.x+c.width/2,y:c.y+c.height/2}}));var i=document.getElementById("".concat(a.moduleId,"-").concat(a.portId)).getBoundingClientRect();e(x({portId:r,toPortId:"".concat(a.moduleId,"-").concat(a.portId),toPoint:{x:i.x+i.width/2,y:i.y+i.height/2}}))}),$e=Object(C.a)(Object(C.c)("preset","setPreset",""),Object(p.b)(null,{loadPreset:function(e){return function(t,n){Xe.a(function(e){return t(w(e.type,e.id))})(e.modules),setTimeout(function(){return Xe.a(Je(t,n))(e.connections)},250)}}}))(function(e){var t=e.preset,n=e.setPreset,o=e.loadPreset;return a.a.createElement("div",null,a.a.createElement("select",{value:t,onChange:function(e){var t=e.target.value;n(t),o(He[t])}},""===t&&a.a.createElement("option",{value:""},"Select Preset"),E.a(j.a,b.a(function(e){return a.a.createElement("option",{key:e,value:e},e)}))(He)))}),Ze=(n(77),n(79),function(){return a.a.createElement("img",{alt:"screw",src:n(81),height:14,width:14,style:{margin:5}})}),et=function(e){var t=e.children;return a.a.createElement("div",{className:"panel_edge"},a.a.createElement(Ze,null),t,a.a.createElement(Ze,null))},tt=function(e){var t=e.children,n=e.dragging,o=e.setDragging,r=e.width,c=e.left;return a.a.createElement("div",{className:"module-panel",style:{width:r,left:c,cursor:n?"grabbing":"grab"},onMouseDown:function(){return o(!0)},onMouseUp:function(){return o(!1)}},a.a.createElement(et,null),a.a.createElement("div",{className:"panel_content"},t),a.a.createElement(et,null))},nt=new Float32Array(256),ot=0;ot<128;ot++)nt[ot]=-1,nt[ot+128]=1;var at=new Float32Array(2);function rt(){var e=this.createOscillator();e.type="sawtooth";var t=this.createWaveShaper();t.curve=nt,e.connect(t);var n=this.createGain();n.gain.value=0,e.width=n.gain,e.widthGain=n,n.connect(t);var o=this.createWaveShaper();return o.curve=at,e.connect(o),o.connect(n),e.connect=function(){return t.connect.apply(t,arguments),e},e.disconnect=function(){return t.disconnect.apply(t,arguments),e},e}at[0]=1,at[1]=1;var ct=function(e){for(var t=new Float32Array(8192),n=0;n<8192;n++){var o=n/8191*4-2;t[n]=e*Math.pow(2,o)}return t};function it(e,t){var n=this.createConstantSource();n.volt=n.offset;var o=this.createWaveShaper(),a=this.createGain();return o.curve=ct(e),a.gain.value=1/t,n.connect(a).connect(o),n.connect=function(){return o.connect.apply(o,arguments),a},n.disconnect=function(){return o.disconnect.apply(o,arguments),a},n}var ut=function(e){function t(e){var n;Object(i.a)(this,t),n=Object(l.a)(this,Object(d.a)(t).call(this,e));var o=window.AudioContext||window.webkitAudioContext;return n._audioContext=new o,n._audioContext.createPulseOscillator=rt,n._audioContext.createVoltToHzConverter=it,n.handleMouseUp=n.handleMouseUp.bind(Object(g.a)(Object(g.a)(n))),n.handleMouseMove=n.handleMouseMove.bind(Object(g.a)(Object(g.a)(n))),n.handleDragging=n.handleDragging.bind(Object(g.a)(Object(g.a)(n))),n._analyser=n._audioContext.createAnalyser(),window.analyser=n._analyser,window.visuallize=n.visuallize=n.visuallize.bind(Object(g.a)(Object(g.a)(n))),n}return Object(s.a)(t,e),Object(u.a)(t,[{key:"visuallize",value:function(){var e=this._canvas,t=e.getContext("2d"),n=this._analyser;n.fftSize=1024;var o=new Float32Array(n.frequencyBinCount);e.width=o.length,e.height=200;var a=e.width,r=e.height;t.clearRect(0,0,a,r),function e(){setTimeout(function(){return window.v=requestAnimationFrame(e)},300),n.getFloatTimeDomainData(o),t.fillStyle="rgb(200, 200, 200)",t.fillRect(0,0,a,r),t.lineWidth=2,t.strokeStyle="rgb(0, 0, 0)",t.beginPath();for(var c=0,i=0;i<o.length;i++){c=i;var u=(.5+o[i]/2)*r;0===i?t.moveTo(c,u):t.lineTo(c,u)}t.stroke()}()}},{key:"componentDidUpdate",value:function(e){var t,n=this.props,o=n.modules,a=n.modifyModuleCables,r=We.a(function(n){var o=n.id,a=n.left;return t=We.a(ke.a({id:Ke.a(o),left:be.a(Ke.a(a))}))(e.modules),!Oe.a(t)})(o);r&&a({moduleId:r.id,diff:r.left-t.left})}},{key:"handleMouseUp",value:function(){var e=this.props,t=e.unsetStartingPort,n=e.removeCable,o=e.startingPort;o&&(n("".concat(o.moduleId,"-").concat(o.portId)),t())}},{key:"handleMouseMove",value:function(e){this.moveCable(e),this.dragModule(e)}},{key:"moveCable",value:function(e){var t=this.props,n=t.modifyCable,o=t.startingPort;o&&n({portId:"".concat(o.moduleId,"-").concat(o.portId),toPoint:{x:e.clientX,y:e.clientY}})}},{key:"dragModule",value:function(e){var t=this.props,n=t.draggingModuleId,o=t.moveModule;n&&o(n,e.clientX)}},{key:"handleDragging",value:function(e){var t=this;return function(n){t.props.setDraggingModuleId(n?e:null)}}},{key:"render",value:function(){var e=this,t=this.props,n=t.modules,o=t.draggingModuleId;return a.a.createElement("div",{onMouseUp:this.handleMouseUp,onMouseMove:this.handleMouseMove},a.a.createElement(Ye,null),a.a.createElement($e,null),a.a.createElement("div",null,a.a.createElement("div",{className:"rack"},n.map(function(t){var n=t.Module,r=t.id,c=t.width,i=t.left;return a.a.createElement(tt,{key:r,setDragging:e.handleDragging(r),dragging:r===o,width:c,left:i},a.a.createElement(n,{id:r,audioContext:e._audioContext}))})),a.a.createElement(ze,null)),a.a.createElement("canvas",{ref:function(t){return e._canvas=t},className:"visualizer",width:"640",height:"100"}))}}]),t}(o.Component),lt=Object(C.a)(Object(C.c)("draggingModuleId","setDraggingModuleId",null),Object(p.b)(function(e){return{modules:we.a(e.modules.modules),startingPort:e.modules.startingPort}},{modifyCable:x,removeCable:D,unsetStartingPort:A,moveModule:function(e,t){return{type:"MOVE_MODULE",moduleId:e,x:t}},modifyModuleCables:function(e){return{type:"MODIFY_MODULE_CABLES",moduleId:e.moduleId,diff:e.diff}}}))(ut),dt=(n(82),function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return a.a.createElement(p.a,{store:Le},a.a.createElement("div",{className:"App"},a.a.createElement(lt,null)))}}]),t}(o.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(a.a.createElement(dt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[50,2,1]]]);
//# sourceMappingURL=main.37b04882.chunk.js.map