(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{56:function(e,t,n){e.exports=n(82)},61:function(e,t,n){},67:function(e,t,n){},68:function(e,t,n){e.exports=n.p+"static/media/port.1b33f6c1.svg"},69:function(e,t,n){e.exports=n.p+"static/media/knob.23f417df.svg"},70:function(e,t,n){var o={"./pulse.svg":71,"./sawtooth.svg":72,"./sine.svg":73,"./triangle.svg":74};function a(e){var t=c(e);return n(t)}function c(e){if(!n.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}a.keys=function(){return Object.keys(o)},a.resolve=c,e.exports=a,a.id=70},71:function(e,t,n){e.exports=n.p+"static/media/pulse.f9689bc2.svg"},72:function(e,t,n){e.exports=n.p+"static/media/sawtooth.de511017.svg"},73:function(e,t,n){e.exports=n.p+"static/media/sine.e1994103.svg"},74:function(e,t,n){e.exports=n.p+"static/media/triangle.87d20148.svg"},75:function(e,t,n){},79:function(e,t,n){},80:function(e,t,n){e.exports=n.p+"static/media/screw_header.2c2805d6.svg"},81:function(e,t,n){},82:function(e,t,n){"use strict";n.r(t);var o=n(0),a=n.n(o),c=n(29),r=n.n(c),l=(n(61),n(6)),u=n(21),s=n(43),i=n(8),d=n(101);var p=n(20),m=n(47),O=n(3),E=n(87),b=n(103),I=n(12),f=n(54),v=n(33),C=n(83),y=n(84),h=n(105);const g=({portId:e,fromPoint:t,color:n})=>({type:"ADD_CABLE",portId:e,fromPoint:t,color:n}),j=({portId:e,fromPoint:t,toPoint:n,toPortId:o})=>({type:"MODIFY_CABLE",portId:e,fromPoint:t,toPoint:n,toPortId:o}),S=e=>({type:"REMOVE_CABLE",portId:e}),w=e=>({type:"CHANGE_OVER_PORT",portId:e}),A=(e,t,n)=>({type:"ADD_MODULE",moduleType:e,id:t,rackId:n}),T=({output:e,input:t})=>({type:"CONNECT_MODULES",output:e,input:t}),P=e=>({type:"DISCONNECT_MODULE",port:e}),k=(e,t)=>({type:"REGISTER_INPUTS",id:e,inputs:t}),x=(e,t)=>({type:"REGISTER_OUTPUTS",id:e,outputs:t}),D=e=>({type:"SET_STARTING_PORT",port:e}),M=()=>({type:"UNSET_STARTING_PORT"}),R=(e,t,n)=>({type:"MOVE_MODULE",moduleId:e,x:t,rackId:n}),_=e=>(t,n)=>{const o=n(),a=o.modules,c=a.modules,r=a.connections,l=o.cables.cables,u=c[e];if(!u)return;const s=b.a(I.a,f.a(t=>v.a([e,t],r)),C.a(n=>{t(P({moduleId:e,portId:n}));let o="".concat(e,"-").concat(n);l[o]||(o=b.a(f.a(y.a("toPortId",o)),I.a,h.a)(l)),t(S(o))}));u.inputs&&s(u.inputs),u.outputs&&s(u.outputs),t({type:"REMOVE_MODULE",moduleId:e})};var V=n(85),N=n(106),L=n(107),B=n(44),G=n.n(B),U=n(35),F=n.n(U);n(67);function W(e){const t=Object(l.b)();return Object(o.useCallback)(b.a(e,t),[e,t])}const Y="HIDE",q="ABOVE",z="BELOW";var H=({label:e,labelPosition:t=q,portId:c,moduleId:r,portType:u})=>{const s=Object(l.c)(v.a(["modules","startingPort"])),i=Object(l.c)(v.a(["modules","connections",r,c])),d=Object(l.c)(b.a(v.a(["cables","cables"]),V.a)),p=W(T),m=W(P),O=W(D),E=W(M),I=W(g),f=W(S),C=W(j),y=W(w),h=Object(o.useMemo)(()=>"".concat(r,"-").concat(c),[r,c]),A=Object(o.useRef)(null);Object(o.useEffect)(()=>{const e=N.a(L.a({portId:h}),d);if(e){const t=A.current.getBoundingClientRect(),n=t.x,o=t.y,a=t.width,c=t.height;C({portId:e.portId,fromPoint:{x:n+a/2,y:o+window.scrollY+c/2}})}else{const e=N.a(L.a({toPortId:h}),d);if(e){const t=A.current.getBoundingClientRect(),n=t.x,o=t.y,a=t.width,c=t.height;C({portId:e.portId,toPoint:{x:n+a/2,y:o+window.scrollY+c/2}})}}},[i]);const k=e||c;return a.a.createElement("div",{className:G()("port",{disabled:s&&s.portType===u}),onMouseDown:e=>{e.stopPropagation();const t={portId:c,portType:u,moduleId:r};i&&(m({moduleId:r,portId:c}),f("".concat(i.moduleId,"-").concat(i.portId))),O(t);const n=A.current.getBoundingClientRect(),o=n.x,a=n.y,l=n.width,s=n.height;I({portId:h,fromPoint:{x:o+l/2,y:a+window.scrollY+s/2},color:F()({luminosity:"dark"})})},onMouseUp:e=>{if(E(),!s||s.portType===u||s.moduleId===r&&s.id===c)return;e.stopPropagation();const t=A.current.getBoundingClientRect(),n=t.x,o=t.y,a=t.width,l=t.height;!i||i.moduleId===s.moduleId&&i.portId===s.portId||(f("".concat(i.moduleId,"-").concat(i.portId)),f(h)),C({portId:"".concat(s.moduleId,"-").concat(s.portId),toPoint:{x:n+a/2,y:o+l/2},toPortId:h}),p({[s.portType]:s,[u]:{moduleId:r,portId:c}})}},t===q&&k,a.a.createElement("img",{id:h,height:"30",width:"30",ref:A,onMouseEnter:()=>y(h),onMouseLeave:()=>y(null),onMouseDown:e=>e.preventDefault(),src:n(68),alt:h}),t===z&&k)};var K=({onChange:e,max:t,min:c,value:r,step:l,label:u,height:s=50,width:i=50})=>{const d=Object(o.useState)(!1),p=Object(O.a)(d,2),m=p[0],E=p[1],b=Object(o.useRef)(null),I=Object(o.useCallback)(n=>{if(!m)return;if(n.stopPropagation(),n.preventDefault(),1!==n.buttons)return;const o=b.current.getBoundingClientRect(),a=o.x,r=o.y,u=a+o.width/2,s=r+o.height/2,i=n.clientX-u,d=n.clientY-s;let p=180*Math.atan2(d,i)/Math.PI;p<0&&(p+=360),(p-=120)<0&&(p+=360),p>315&&(p=0);let O=p/300*(t-c)+c;(O=Math.floor(O/l)*l)>t&&(O=t),e(O)},[m,c,t,e,l]),f=Object(o.useCallback)(e=>{e.stopPropagation(),E(!0)},[]),v=Object(o.useCallback)(()=>{E(!1)},[]),C=Object(o.useCallback)(()=>(r-c)/(t-c)*2*150,[c,t,r]);return Object(o.useEffect)(()=>(document.addEventListener("mouseup",v),document.addEventListener("mousemove",I),()=>{document.removeEventListener("mouseup",v),document.removeEventListener("mousemove",I)}),[v,I]),a.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},u,a.a.createElement("img",{ref:b,style:{cursor:"pointer",margin:"auto",transform:"rotate(".concat(C(),"deg)")},onMouseDown:f,alt:"knob",src:n(69),height:s,width:i}))},X={container:{display:"flex",flexDirection:"column",height:"100%"},body:{display:"flex",flexDirection:"column",flex:1,justifyContent:"space-evenly"},spaceAround:{display:"flex",justifyContent:"space-around"}},J=n(108),Q=n(109),$=n(86);const Z={};function ee(e,t){const n=Object(o.useState)(null),a=Object(O.a)(n,2),c=a[0],r=a[1],u=Object(l.c)(b.a(v.a(["modules","modules"]),I.a));return Object(o.useEffect)(()=>{b.a(J.a(Q.a,[m.a(u),I.a]),C.a(e=>delete Z[e]))(Z)},[u]),Object(o.useEffect)(()=>{console.debug("useModule rendered for ".concat(e));const n=Z[e];if($.a(n)){const n=t();n.id=e,Z[e]=n,r(n)}else r(n)},[e,t]),c}function te(e,t){const n=Object(o.useRef)(t),a=Object(o.useState)(null),c=Object(O.a)(a,2),r=c[0],l=c[1];return Object(o.useEffect)(()=>n.current=t,[t]),Object(o.useEffect)(()=>{if(!e)return;const t=function(e){for(let t in e)if(e[t]instanceof AudioParam)return e[t];return null}(e);if(t){let e=t.value;n.current(e),l(setInterval(()=>{e!==t.value&&(e=t.value,n.current(e))},0))}},[e]),r}function ne(e){return Object(l.c)(v.a(["modules","connections",e]))}const oe=(e,t)=>{const n=e.createOscillator();return n.type=t,n.frequency.value=0,n},ae=({id:e,audioContext:t})=>{const c=W(k),r=W(x),l=Object(o.useState)(0),u=Object(O.a)(l,2),s=u[0],d=u[1],m=Object(o.useState)(0),f=Object(O.a)(m,2),v=f[0],C=f[1],y=Object(o.useState)(0),h=Object(O.a)(y,2),g=h[0],j=h[1],S=Object(o.useState)(0),w=Object(O.a)(S,2),A=w[0],T=w[1],P=Object(o.useState)(0),D=Object(O.a)(P,2),M=D[0],R=D[1],_=Object(o.useCallback)(()=>{const e=t.createPulseOscillator();e.frequency.value=0,e.width.value=0;const n={Sawtooth:oe(t,"sawtooth"),Pulse:e,Triangle:oe(t,"triangle"),Sine:oe(t,"sine")},o=t.createVoltToHzConverter(440,4),a=t.createConstantSource();o.volt.value=0,a.offset.value=0;const c=t.createGain();c.gain.value=0,c.connect(o.volt),E.a(e=>o.connect(e.frequency))(n),E.a(e=>a.connect(e.detune))(n);const r=t.createGain();return r.gain.value=0,r.connect(n.Pulse.width),E.a(e=>e.start())(n),o.start(),a.start(),{oscillators:n,frequencyControl:o,detuneControl:a,fmGain:c,pwCvGain:r}},[t]),V=ee(e,_);Object(o.useEffect)(()=>{V&&(c(e,{"V/Oct":{connect:e=>e.connect(V.frequencyControl.volt),disconnect:e=>e.disconnect(V.frequencyControl.volt)},PWM:{connect:e=>e.connect(V.pwCvGain),disconnect:e=>e.disconnect(V.pwCvGain)},FM:{connect:e=>e.connect(V.fmGain),disconnect:e=>e.disconnect(V.fmGain)}}),r(e,{Sawtooth:V.oscillators.Sawtooth,Pulse:V.oscillators.Pulse,Triangle:V.oscillators.Triangle,Sine:V.oscillators.Sine}))},[V,e,c,r]);const N=Object(o.useCallback)(e=>{d(e),V.frequencyControl.volt.value=e},[V]),L=Object(o.useCallback)(e=>{C(e),V.detuneControl.offset.value=e},[V]),B=Object(o.useCallback)(e=>{j(e),V.oscillators.Pulse.width.value=e},[V]),G=Object(o.useCallback)(e=>{T(e),V.pwCvGain.gain.value=e/10},[V]),U=Object(o.useCallback)(e=>{R(e),V.fmGain.gain.value=e},[V]);return a.a.createElement("div",{style:X.container},a.a.createElement("span",null,"VCO"),a.a.createElement("div",{style:Object(i.a)({},X.body,{justifyContent:"space-between"})},a.a.createElement("div",{style:X.spaceAround},a.a.createElement("div",{style:Object(i.a)({},X.spaceAround,{flexDirection:"column"})},a.a.createElement(H,{portId:"V/Oct",moduleId:e,portType:"input"}),a.a.createElement(H,{portId:"FM",moduleId:e,portType:"input"}),a.a.createElement(H,{portId:"PWM",moduleId:e,portType:"input"})),a.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},a.a.createElement(K,{label:"Range",min:-4,max:4,step:.001,value:s,width:30,height:30,onChange:N}),a.a.createElement(K,{label:"Tune",min:-600,max:600,step:1,value:v,width:30,height:30,onChange:L}),a.a.createElement(K,{label:"FM CV",min:0,max:1,step:.005,value:M,width:30,height:30,onChange:U}),a.a.createElement(K,{label:"PW",min:-1,max:1,step:.001,value:g,width:30,height:30,onChange:B}),a.a.createElement(K,{label:"PWM CV",min:0,max:1,step:.005,value:A,width:30,height:30,onChange:G}))),a.a.createElement("div",{style:X.spaceAround},V&&b.a(I.a,p.a(t=>a.a.createElement(H,{key:t,label:a.a.createElement("img",{width:25,src:n(70)("./".concat(t.toLowerCase(),".svg")),alt:t}),labelPosition:z,portId:t,moduleId:e,portType:"output"})))(V.oscillators))))};ae.isBrowserSupported="undefined"!==typeof OscillatorNode&&"undefined"!==typeof ConstantSourceNode,ae.panelWidth=8;var ce=ae;const re=({id:e,audioContext:t})=>{const n=ne(e),c=W(k),r=Object(o.useCallback)(()=>{const e=new StereoPannerNode(t,{pan:-1}),n=new StereoPannerNode(t,{pan:1});return e.connect(t.destination),n.connect(t.destination),{leftPanner:e,rightPanner:n}},[t]),l=ee(e,r);return Object(o.useEffect)(()=>{l&&c(e,{Left:{connect:e=>e.connect(l.leftPanner),disconnect:e=>e.disconnect(l.leftPanner)},Right:{connect:e=>e.connect(l.rightPanner),disconnect:e=>e.disconnect(l.rightPanner)}})},[l,e,c]),a.a.createElement("div",{style:X.container},a.a.createElement("span",null,"Stereo"),a.a.createElement("div",{style:X.body},a.a.createElement(H,{portId:"Left",connections:n,moduleId:e,portType:"input"}),a.a.createElement(H,{portId:"Right",connections:n,moduleId:e,portType:"input"})))};re.isBrowserSupported="undefined"!==typeof StereoPannerNode,re.panelWidth=4;var le=re;const ue=({id:e,audioContext:t})=>{const n=ne(e),c=W(k);return Object(o.useEffect)(()=>{c(e,{In:{connect:e=>e.connect(t.destination),disconnect:e=>e.disconnect(t.destination)}})},[e,c,t]),a.a.createElement("div",{style:X.container},a.a.createElement("span",null,"Mono"),a.a.createElement("div",{style:X.body},a.a.createElement(H,{portId:"In",connections:n,moduleId:e,portType:"input"})))};ue.isBrowserSupported=!0,ue.panelWidth=4;var se=ue,ie=n(88);const de=[90,83,88,68,67,86,71,66,72,78,74,77,188],pe=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B","C"],me={"C#":"1/4","D#":"3/6","F#":"6/9","G#":"8/11","A#":"10/13"},Oe=(e,t)=>t-5+(e+3)/12,Ee=({id:e,audioContext:t})=>{const n=ne(e),c=W(x),r=Object(o.useState)(4),l=Object(O.a)(r,2),u=l[0],s=l[1],i=Object(o.useState)(0),d=Object(O.a)(i,2),p=d[0],m=d[1],E=Object(o.useState)(!1),b=Object(O.a)(E,2),I=b[0],f=b[1],v=Object(o.useCallback)(()=>{const e=t.createConstantSource();e.offset.value=0,e.start();const n=t.createConstantSource();return n.offset.value=0,n.start(),{gate:e,cv:n}},[t]),C=ee(e,v);Object(o.useEffect)(()=>{C&&c(e,{CV:C.cv,Gate:C.gate})},[e,C,c]),Object(o.useEffect)(()=>{C&&(C.cv.offset.value=p)},[C,p]);const y=Object(o.useCallback)(e=>{m(e),C.gate.offset.value=1},[C]),h=Object(o.useCallback)(()=>{C.gate.offset.value=0},[C]),g=Object(o.useCallback)(e=>{const t=ie.a(e.keyCode,de);I||-1===t||(f(!1),y(Oe(t,u)))},[I,y,u]),j=Object(o.useCallback)(()=>{f(!1),h()},[h]);Object(o.useEffect)(()=>{document.onkeydown=g,document.onkeyup=j},[g,j]);const S=Object(o.useCallback)(({target:{value:e}})=>{const t=Number(e),n=C.cv.offset.value;m(n+t-u),s(t)},[C,u]);return a.a.createElement("div",{style:X.container},a.a.createElement("span",null,"\xb5Keyboard"),a.a.createElement("div",{style:X.body},"Octave",a.a.createElement("select",{value:u,onChange:S},a.a.createElement("option",{value:2},"-2"),a.a.createElement("option",{value:3},"-1"),a.a.createElement("option",{value:4},"0"),a.a.createElement("option",{value:5},"+1"),a.a.createElement("option",{value:6},"+2")),a.a.createElement("div",{style:{display:"grid",flex:1}},pe.map((e,t)=>{const n=e.endsWith("#"),o=n?me[e]:t+1;return[a.a.createElement("div",{key:"TITLE_".concat(e).concat(t),style:{alignSelf:"center",gridRow:o,gridColumn:n?4:1}},e),a.a.createElement("button",{key:"".concat(e).concat(t),onMouseDown:e=>{e.stopPropagation(),y(Oe(t,u))},onMouseUp:h,style:{height:20,width:20,gridRow:o,alignSelf:"center",gridColumn:n?3:2,backgroundColor:n?"black":"white"}})]})),a.a.createElement("div",{style:X.spaceAround},a.a.createElement(H,{portId:"CV",connections:n,moduleId:e,portType:"output"}),a.a.createElement(H,{portId:"Gate",connections:n,moduleId:e,portType:"output"}))))};Ee.isBrowserSupported="undefined"!==typeof ConstantSourceNode,Ee.panelWidth=6;var be=Ee;const Ie=e=>15*Math.pow(e,4)+.001,fe=({id:e,audioContext:t})=>{const n=ne(e),c=W(k),r=W(x),l=Object(o.useState)(null),u=Object(O.a)(l,2),s=u[0],i=u[1],d=Object(o.useState)(.5),p=Object(O.a)(d,2),m=p[0],E=p[1],b=Object(o.useState)(.5),I=Object(O.a)(b,2),f=I[0],v=I[1],C=Object(o.useState)(.5),y=Object(O.a)(C,2),h=y[0],g=y[1],j=Object(o.useState)(.5),S=Object(O.a)(j,2),w=S[0],A=S[1],T=Object(o.useCallback)(()=>{const e=t.createConstantSource();return e.offset.value=0,e.start(),{adsr:e}},[t]),P=ee(e,T),D=te(s,Object(o.useCallback)(e=>{if(!P)return;const n=Ie(m)+.01,o=Ie(f),a=Ie(w),c=t.currentTime,r=P.adsr.offset;1===e?(r.cancelScheduledValues(c),r.setValueAtTime(r.value,c),r.linearRampToValueAtTime(1,c+n),r.linearRampToValueAtTime(h,c+n+o)):0===e&&(r.cancelScheduledValues(c),r.setValueAtTime(r.value,c),r.linearRampToValueAtTime(0,c+a))},[P,m,f,h,w,t.currentTime]));return Object(o.useEffect)(()=>{P&&(c(e,{Gate:{connect:i,disconnect:()=>{i(null),D&&clearInterval(D)}}}),r(e,{Out:P.adsr}))},[P,D,c,r,e]),a.a.createElement("div",{style:X.container},a.a.createElement("span",null,"ADSR"),a.a.createElement("div",{style:X.body},"Attack:",a.a.createElement(K,{min:0,max:1,step:.001,value:m,onChange:e=>E(e),width:30,height:30}),"Decay:",a.a.createElement(K,{min:0,max:1,step:.001,value:f,onChange:e=>v(e),width:30,height:30}),"Sustain:",a.a.createElement(K,{min:0,max:1,step:.01,value:h,onChange:e=>g(Number(e)),width:30,height:30}),"Release:",a.a.createElement(K,{min:0,max:1,step:.001,value:w,onChange:e=>A(Number(e)),width:30,height:30}),a.a.createElement("div",{style:X.spaceAround},a.a.createElement(H,{portId:"Gate",connections:n,moduleId:e,portType:"input"}),a.a.createElement(H,{portId:"Out",connections:n,moduleId:e,portType:"output"}))))};fe.isBrowserSupported="undefined"!==typeof ConstantSourceNode,fe.panelWidth=6;var ve=fe;const Ce=({id:e,audioContext:t})=>{const n=ne(e),c=W(k),r=W(x),l=Object(o.useCallback)(()=>({gain:t.createGain()}),[t]),u=ee(e,l);return Object(o.useEffect)(()=>{u&&(c(e,{In:{connect:e=>e.connect(u.gain),disconnect:e=>e.disconnect(u.gain)},CV:{connect:e=>(u.gain.gain.linearRampToValueAtTime(0,t.currentTime+.01),e.connect(u.gain.gain)),disconnect:e=>{u.gain.gain.linearRampToValueAtTime(1,t.currentTime+.01),e.disconnect(u.gain.gain),e.offset&&(e.offset.value=0)}}}),r(e,{Out:u.gain}))},[u,e,c,r,t]),a.a.createElement("div",{style:X.container},a.a.createElement("span",null,"VCA"),a.a.createElement("div",{style:X.body},a.a.createElement(H,{portId:"In",connections:n,moduleId:e,portType:"input"}),a.a.createElement(H,{portId:"CV",connections:n,moduleId:e,portType:"input"}),a.a.createElement(H,{portId:"Out",connections:n,moduleId:e,portType:"output"})))};Ce.isBrowserSupported="undefined"!==typeof GainNode,Ce.panelWidth=4;var ye=Ce;const he=({id:e,audioContext:t})=>{const n=ne(e),c=W(k),r=W(x),l=Object(o.useState)(.5),u=Object(O.a)(l,2),s=u[0],d=u[1],p=Object(o.useState)(.1),m=Object(O.a)(p,2),E=m[0],b=m[1],I=Object(o.useState)(.5),f=Object(O.a)(I,2),v=f[0],C=f[1],y=Object(o.useState)(.5),h=Object(O.a)(y,2),g=h[0],j=h[1],S=Object(o.useCallback)(()=>{const e=t.createBiquadFilter(),n=t.createVoltToHzConverter(440,2),o=t.createVoltToHzConverter(440,2),a=t.createVoltToHzConverter(440,2),c=t.createGain(),r=t.createGain();return n.volt.value=0,n.start(),n.connect(e.frequency),o.volt.value=0,o.start(),o.connect(c),c.gain.value=.5,c.connect(e.frequency),a.volt.value=0,a.start(),a.connect(r),r.gain.value=.5,r.connect(e.frequency),e.type="lowpass",e.Q.value=.5,{vcf:e,cv:n,cv2:o,cv3:a,cv2Gain:c,cv3Gain:r}},[t]),w=ee(e,S);Object(o.useEffect)(()=>{w&&(window.vcf=w,c(e,{In:{connect:e=>e.connect(w.vcf),disconnect:e=>e.disconnect(w.vcf)},CV1:{connect:e=>e.connect(w.cv.volt),disconnect:e=>e.disconnect(w.cv.volt)},CV2:{connect:e=>e.connect(w.cv2.volt),disconnect:e=>e.disconnect(w.cv2.volt)},CV3:{connect:e=>e.connect(w.cv3.volt),disconnect:e=>e.disconnect(w.cv3.volt)}}),r(e,{Out:w.vcf}))},[w,e,c,r]),Object(o.useEffect)(()=>{if(!w)return;const e=t.sampleRate/2,n=Math.log(e/40)/Math.LN2,o=Math.pow(2,n*(s-1));w.vcf.frequency.setValueAtTime(e*o,t.currentTime)},[w,s,t]);const A=Object(o.useCallback)(e=>{d(Number(e))},[]);Object(o.useEffect)(()=>{w&&(w.vcf.Q.value=30*E)},[w,E]);const T=Object(o.useCallback)(e=>{b(Number(e))},[]);Object(o.useEffect)(()=>{w&&(w.cv2Gain.gain.value=v)},[w,v]);const P=Object(o.useCallback)(e=>{C(Number(e))},[]);Object(o.useEffect)(()=>{w&&(w.cv3Gain.gain.value=g)},[w,g]);const D=Object(o.useCallback)(e=>{j(Number(e))},[]);return a.a.createElement("div",{style:{display:"flex",flexDirection:"column",height:"100%"}},a.a.createElement("span",{style:{display:"flex",flexDirection:"column"}},"VCF",a.a.createElement("span",{style:{fontSize:10}},"LOW PASS FILTER")),a.a.createElement("div",{style:Object(i.a)({},X.spaceAround,{flex:1})},a.a.createElement("div",{style:Object(i.a)({},X.spaceAround,{flexDirection:"column"})},a.a.createElement(H,{portId:"CV1",connections:n,moduleId:e,portType:"input"}),a.a.createElement(H,{portId:"CV2",connections:n,moduleId:e,portType:"input"}),a.a.createElement(H,{portId:"CV3",connections:n,moduleId:e,portType:"input"}),a.a.createElement(H,{portId:"In",connections:n,moduleId:e,portType:"input"}),a.a.createElement(H,{portId:"Out",connections:n,moduleId:e,portType:"output"})),a.a.createElement("div",{style:Object(i.a)({},X.spaceAround,{flexDirection:"column"})},"Frequency",a.a.createElement(K,{min:0,max:1,step:.01,value:s,width:30,height:30,onChange:e=>A(e)}),"CV 2",a.a.createElement(K,{min:0,max:1,step:.01,value:v,width:30,height:30,onChange:e=>P(e)}),"CV 3",a.a.createElement(K,{min:0,max:1,step:.01,value:g,width:30,height:30,onChange:e=>D(e)}),"Res",a.a.createElement(K,{min:0,max:1,step:.01,value:E,width:30,height:30,onChange:e=>T(e)}))))};he.isBrowserSupported="undefined"!==typeof BiquadFilterNode,he.panelWidth=6;var ge=he;const je=({id:e,audioContext:t})=>{const n=ne(e),c=W(k),r=W(x),l=Object(o.useState)({A:null,B:null}),u=Object(O.a)(l,2),s=u[0],d=u[1],p=Object(o.useCallback)(()=>{return{groupA:{input:null,audioNode:null},groupB:{input:null,audioNode:null}}},[t]),m=ee(e,p);Object(o.useEffect)(()=>{if(!m)return;const t=e=>{const t={},n=m["group".concat(e)];for(let o=1;o<=4;o++)t["Group".concat(e).concat(o,"In")]={connect:t=>{d(Object(i.a)({},s,{[e]:o})),n.input=o,n.audioNode=t},disconnect:()=>{d(Object(i.a)({},s,{[e]:null})),n.audioNode=null}};return t},n=e=>{const t={};for(let n=1;n<=4;n++)t["Group".concat(e).concat(n,"Out")]=(()=>m["group".concat(e)].audioNode);return t};c(e,Object(i.a)({},t("A"),t("B"))),r(e,Object(i.a)({},n("A"),n("B")))},[m,e,c,r]);const E=Object(o.useCallback)(t=>{const o=[];for(let c=1;c<=4;c++){const r=$.a(s[t])||s[t]===c,l={key:"Group".concat(t).concat(c),portId:"Group".concat(t).concat(c).concat(r?"In":"Out"),connections:n,moduleId:e,portType:r?"input":"output",labelPosition:Y};o.push(a.a.createElement(H,l))}return o},[s]);return a.a.createElement("div",{style:X.container},a.a.createElement("span",{style:{fontSize:13}},"Multiples"),a.a.createElement("div",{style:X.body},a.a.createElement("div",null,E("A")),a.a.createElement("div",null,E("B"))))};je.isBrowserSupported="undefined"!==typeof ConstantSourceNode,je.panelWidth=3;var Se=je;const we={VCO:"VCO",STEREO_AUDIO_INTERFACE:"STEREO_AUDIO_INTERFACE",MONO_AUDIO_INTERFACE:"MONO_AUDIO_INTERFACE",KEYBOARD:"KEYBOARD",ADSR:"ADSR",VCA:"VCA",VCF_LOW_PASS:"VCF_LOW_ASS",MULTIPLES:"MULTIPLES"},Ae=p.a(m.a(1))(we);var Te=n(89),Pe=n(90),ke=n(91),xe=n(102),De=n(104),Me=n(92),Re=n(93),_e=n(50),Ve=n(51),Ne=n(49),Le=n(94),Be=n(95),Ge=n(48),Ue=n(110),Fe=n(96),We=n(97),Ye=n(111),qe=n(45);const ze=Te.a(({moduleId:e,portId:t},n)=>Pe.a(ke.a(xe.a($.a),[e,t]),b.a(v.a([e,t]),e=>De.a([e.moduleId,e.portId],n)))(n));var He=Object(d.a)({ADD_MODULE:(e,{moduleType:t,id:n,rackId:o=0})=>{const a=(({type:e,id:t})=>{const n={id:t||"".concat(e).concat(Ae[e])};switch(e){case we.VCO:n.Module=ce;break;case we.STEREO_AUDIO_INTERFACE:n.Module=le;break;case we.MONO_AUDIO_INTERFACE:n.Module=se;break;case we.KEYBOARD:n.Module=be;break;case we.ADSR:n.Module=ve;break;case we.VCF_LOW_PASS:n.Module=ge;break;case we.VCA:n.Module=ye;break;case we.MULTIPLES:n.Module=Se;break;default:throw new Error("Cannot create module of type: ".concat(e))}return n.Module.isBrowserSupported?(n.width=20*n.Module.panelWidth,Ae[e]++,n):null})({type:t,id:n});return a?(a.left=e.maxLeft,Me.a({audioContextInitiliazed:Re.a,modules:_e.a(a.id,a),connections:_e.a(a.id,{}),maxLeft:Ve.a(a.width),racks:Ne.a(o,Le.a(a.id))})(e)):(window.alert("Your browser doesn't support this module: ".concat(t)),e)},REGISTER_INPUTS:(e,{id:t,inputs:n})=>Me.a({modules:Me.a({[t]:_e.a("inputs",n)})})(e),REGISTER_OUTPUTS:(e,{id:t,outputs:n})=>Me.a({modules:Me.a({[t]:e=>(Be.a((e,t)=>{"function"===typeof e&&Object.defineProperty(n,t,{get:e})})(n),Object(i.a)({},e,{outputs:n}))})})(e),CONNECT_MODULES:(e,{input:t,output:n})=>Me.a({connections:b.a(ze(n),ze(t),Me.a({[t.moduleId]:_e.a(t.portId,{moduleId:n.moduleId,portId:n.portId,counter:0}),[n.moduleId]:_e.a(n.portId,{moduleId:t.moduleId,portId:t.portId,counter:0})}))})(e),DISCONNECT_MODULE:(e,{port:t})=>Me.a({connections:b.a(ze(t),Me.a({[t.moduleId]:Ge.a(t.portId)}))})(e),SET_STARTING_PORT:(e,{port:t})=>Me.a({startingPort:m.a(t)})(e),UNSET_STARTING_PORT:e=>Me.a({startingPort:m.a(null)})(e),MOVE_MODULE:(e,{moduleId:t,x:n,rackId:o})=>{const a=e.modules[t].left,c=e.modules[t].width,r=a+20*Math.floor((n-a)/20),l=r+c;return l>window.innerWidth?e:b.a(V.a,Ue.a(({id:n,left:a,width:c})=>{const u=a+c;return n!==t&&Fe.a(n,e.racks[o])&&(a>=r&&a<l||a<r&&u>r||a===r&&u===l)}))(e.modules)?e:Me.a({modules:{[t]:{left:m.a(r)}},connections:{[t]:p.a(Me.a({counter:We.a}))},racks:e=>{const n=Ye.a(Fe.a(t),e);return n===o?e:b.a(Ne.a(n,Q.a([t])),Ne.a(o,Le.a(t)))(e)},maxLeft:qe.a(r+e.modules[t].width)})(e)},REMOVE_MODULE:(e,{moduleId:t})=>{const n=e.modules[t];return Me.a({modules:Ge.a(t),racks:e=>{const n=Ye.a(Fe.a(t),e);return Ne.a(n,Q.a([t]))(e)},maxLeft:e=>n.left+n.width===e?n.left:e})(e)}},{audioContextInitiliazed:!1,modules:{},connections:{},startingPort:null,maxLeft:20,racks:[[],[]]}),Ke=n(112),Xe=n(98),Je=n(55);var Qe=Object(d.a)({ADD_CABLE:(e,{portId:t,fromPoint:n,color:o})=>Me.a({cables:_e.a(t,{portId:t,fromPoint:n,toPoint:n,color:o})})(e),MODIFY_CABLE:(e,{portId:t,fromPoint:n,toPoint:o,toPortId:a})=>Me.a({cables:Me.a({[t]:Ke.a(Xe.a,Je.a($.a,{fromPoint:n,toPoint:o,toPortId:a}))})})(e),REMOVE_CABLE:(e,{portId:t})=>Me.a({cables:Ge.a(t)})(e),CHANGE_OVER_PORT:(e,{portId:t})=>Object(i.a)({},e,{overPort:t})},{cables:{},overPort:null});const $e=e=>t=>Object(i.a)({},t,{isDirty:e});var Ze=Object(d.a)({LOAD_PRESET_START:e=>Object(i.a)({},e,{presetLoading:!0}),LOAD_PRESET_FINISH:e=>Object(i.a)({},$e(!1)(e),{presetLoading:!1}),REMOVE_MODULE:$e(!0),ADD_MODULE:$e(!0),REMOVE_CABLE:$e(!0),ADD_CABLE:$e(!0)},{presetLoading:!1,isDirty:!1}),et=Object(u.c)({modules:He,cables:Qe,rack:Ze}),tt=n(99);var nt=({getState:e})=>t=>n=>{switch(n.type){case"CONNECT_MODULES":{const t=e().modules,o=t.modules,a=t.connections,c=v.a([n.input.moduleId,"inputs",n.input.portId])(o),r=v.a([n.output.moduleId,"outputs",n.output.portId])(o);b.a(v.a([n.output.moduleId,n.output.portId]),tt.a($.a,b.a(({moduleId:e,portId:t})=>v.a([e,"inputs",t])(o),e=>e.disconnect(r))))(a),b.a(v.a([n.input.moduleId,n.input.portId]),tt.a($.a,b.a(({moduleId:e,portId:t})=>v.a([e,"outputs",t])(o),e=>c.disconnect(e))))(a),c&&r&&c.connect(r);break}case"DISCONNECT_MODULE":{const t=e().modules,o=t.modules,a=t.connections,c=v.a([n.port.moduleId,"inputs",n.port.portId])(o);if(c)b.a(v.a([n.port.moduleId,n.port.portId]),({moduleId:e,portId:t})=>v.a([e,"outputs",t])(o),e=>c.disconnect(e))(a);else{const e=v.a([n.port.moduleId,"outputs",n.port.portId])(o);b.a(v.a([n.port.moduleId,n.port.portId]),({moduleId:e,portId:t})=>v.a([e,"inputs",t])(o),t=>t.disconnect(e))(a)}break}}return t(n)};const ot=[s.a,nt];var at=Object(u.d)(et,Object(u.a)(...ot));var ct=()=>{const e=W(A);return a.a.createElement("div",null,a.a.createElement("button",{onClick:()=>e(we.KEYBOARD)},"Add Keyboard"),a.a.createElement("button",{onClick:()=>e(we.VCO)},"Add VCO"),a.a.createElement("button",{onClick:()=>e(we.VCA)},"Add VCA"),a.a.createElement("button",{onClick:()=>e(we.ADSR)},"Add ADSR"),a.a.createElement("button",{onClick:()=>e(we.VCF_LOW_PASS)},"Add VCF Low Pass"),a.a.createElement("button",{onClick:()=>e(we.STEREO_AUDIO_INTERFACE)},"Add Stereo Audio Interface"),a.a.createElement("button",{onClick:()=>e(we.MONO_AUDIO_INTERFACE)},"Add Mono Audio Interface"),a.a.createElement("button",{onClick:()=>e(we.MULTIPLES)},"Add Multiples"))};const rt=(e,t)=>{const n=e.y>t.y?e:t,o=e.y<t.y?e:t,a=.1*Math.abs(t.x-e.x)+Math.abs(e.y-t.y)/.4;let c=.5+Math.log(1+Math.abs((t.y-e.y)/(t.x-e.x)))/(3*Math.log(2));c=n.x<o.x?1-c:c;const r=(e.x<t.x?1:-1)*c*Math.abs(e.x-t.x)||e.x;return"".concat(r," ").concat(a)};var lt=({fromPoint:e,toPoint:t,color:n,overPort:o,portId:c,toPortId:r})=>a.a.createElement("path",{d:"M".concat(e.x," ").concat(e.y," q ").concat(rt(e,t)," ").concat(t.x-e.x," ").concat(t.y-e.y),opacity:o===c||o===r?.9:.6,stroke:n,fill:"transparent",strokeWidth:6});var ut=({scrollLeft:e,height:t,scrollTop:n})=>{const o=Object(l.c)(b.a(v.a(["cables","cables"]),V.a)),c=Object(l.c)(v.a(["cables","overPort"]));return a.a.createElement("svg",{style:{position:"fixed",left:-e,top:-n,width:"calc(100% + ".concat(e,"px)"),height:t,pointerEvents:"none"}},o.map(e=>a.a.createElement(lt,Object.assign({key:e.portId},e,{overPort:c}))))},st={Basic:{modules:[{type:we.KEYBOARD,id:"KEYBOARD1"},{type:we.VCO,id:"VCO1"},{type:we.VCF_LOW_PASS,id:"VCF1"},{type:we.ADSR,id:"ADSR1"},{type:we.VCA,id:"VCA1"},{type:we.MONO_AUDIO_INTERFACE,id:"MONO_AUDIO_INTERFACE1"}],connections:[{input:{moduleId:"VCO1",portId:"V/Oct"},output:{moduleId:"KEYBOARD1",portId:"CV"}},{input:{moduleId:"VCF1",portId:"In"},output:{moduleId:"VCO1",portId:"Sine"}},{input:{moduleId:"ADSR1",portId:"Gate"},output:{moduleId:"KEYBOARD1",portId:"Gate"}},{input:{moduleId:"VCA1",portId:"In"},output:{moduleId:"VCF1",portId:"Out"}},{input:{moduleId:"VCA1",portId:"CV"},output:{moduleId:"ADSR1",portId:"Out"}},{input:{moduleId:"MONO_AUDIO_INTERFACE1",portId:"In"},output:{moduleId:"VCA1",portId:"Out"}}]}},it=n(113),dt=n(46),pt=n(114),mt=n(115);const Ot=Te.a((e,t)=>{const n=t.input,o=t.output;e(T(t));const a="".concat(n.moduleId,"-").concat(n.portId),c=document.getElementById(a).getBoundingClientRect();e(g({portId:a,color:F()({luminosity:"dark"}),fromPoint:{x:c.x+c.width/2,y:c.y+c.height/2}}));const r=document.getElementById("".concat(o.moduleId,"-").concat(o.portId)).getBoundingClientRect();e(j({portId:a,toPortId:"".concat(o.moduleId,"-").concat(o.portId),toPoint:{x:r.x+r.width/2,y:r.y+r.height/2}}))}),Et=e=>(t,n)=>{t({type:"LOAD_PRESET_START"}),t((e,t)=>{b.a(I.a,p.a(t=>e(_(t))))(t().modules.modules),e({type:"REMOVE_ALL_MODULES"})}),setTimeout(bt(t,n,e),10)},bt=(e,t,n)=>()=>{it.a(t().modules.modules)?(C.a(t=>e(A(t.type,t.id)))(n.modules),setTimeout(It(e,t,n),10)):setTimeout(bt(e,t,n),10)},It=(e,t,n)=>()=>{const o=p.a(dt.a("id"),t().modules.modules),a=p.a(dt.a("id"),n.modules);it.a(pt.a(o,a))?(C.a(Ot(e))(n.connections),setTimeout(ft(e,t,n.connections),50)):setTimeout(It(e,t,n),10)},ft=(e,t,n)=>()=>{const o=t().modules.connections;mt.a(e=>{const t=o[e.input.moduleId];if(!t)return!1;const n=t[e.input.portId];return n&&n.moduleId===e.output.moduleId&&n.portId===e.output.portId},n)?e({type:"LOAD_PRESET_FINISH"}):setTimeout(ft(e,t,n),10)};var vt=()=>{const e=Object(l.c)(v.a(["rack","isDirty"])),t=Object(l.c)(v.a(["rack","presetLoading"])),n=W(Et),c=Object(o.useState)(""),r=Object(O.a)(c,2),u=r[0],s=r[1];Object(o.useEffect)(()=>{!t&&e&&s("")},[e,t]);const i=Object(o.useCallback)(({target:{value:e}})=>{s(e),n(st[e])},[n]);return a.a.createElement("div",null,a.a.createElement("select",{value:u,onChange:i},""===u&&a.a.createElement("option",{value:""},"Select Preset"),b.a(I.a,p.a(e=>a.a.createElement("option",{key:e,value:e},e)))(st)))},Ct=(n(75),n(52));n(79);const yt=()=>a.a.createElement("img",{alt:"screw",src:n(80),height:14,width:14,style:{margin:5}}),ht=({children:e})=>a.a.createElement("div",{className:"panel_edge"},a.a.createElement(yt,null),e,a.a.createElement(yt,null));var gt=({children:e,dragging:t,setDragging:n,width:o,left:c,moduleId:r})=>{const l=W(_);return a.a.createElement("div",{className:"module-panel",style:{width:o,left:c,cursor:t?"grabbing":"grab"},onMouseDown:()=>n(!0),onMouseUp:()=>n(!1)},a.a.createElement(ht,null,a.a.createElement("span",{onClick:()=>l(r),className:"btn_delete_module"},a.a.createElement(Ct.a,{size:"xs",icon:"trash"}))),a.a.createElement("div",{className:"panel_content"},e),a.a.createElement(ht,null))};const jt=new Float32Array(256);for(let _t=0;_t<128;_t++)jt[_t]=-1,jt[_t+128]=1;const St=new Float32Array(2);function wt(){const e=this.createOscillator();e.type="sawtooth";const t=this.createWaveShaper();t.curve=jt,e.connect(t);const n=this.createGain();n.gain.value=0,e.width=n.gain,e.widthGain=n,n.connect(t);const o=this.createWaveShaper();return o.curve=St,e.connect(o),o.connect(n),e.connect=function(){return t.connect.apply(t,arguments),e},e.disconnect=function(){return t.disconnect.apply(t,arguments),e},e}St[0]=1,St[1]=1;var At=n(100),Tt=n(116);const Pt=Object(At.a)(Tt.a,(e,t)=>{const n=new Float32Array(8192);for(let o=0;o<8192;o++){const a=o/8191*4-2;n[o]=e*Math.pow(t,a)}return n});function kt(e,t){const n=this.createConstantSource();n.volt=n.offset;const o=this.createWaveShaper(),a=this.createGain();return o.curve=Pt(e,t),a.gain.value=1/t,n.connect(a).connect(o),n.connect=function(){return o.connect.apply(o,arguments),a},n.disconnect=function(){return o.disconnect.apply(o,arguments),a},n}var xt=()=>{const e=Object(l.c)(v.a(["modules","modules"])),t=Object(l.c)(v.a(["modules","racks"])),n=Object(l.c)(v.a(["modules","startingPort"])),c=Object(l.c)(v.a(["modules","audioContextInitiliazed"])),r=W(M),u=W(R),s=W(j),i=W(S),d=Object(o.useState)(null),p=Object(O.a)(d,2),m=p[0],E=p[1],b=Object(o.useState)(0),I=Object(O.a)(b,2),f=I[0],C=I[1],y=Object(o.useState)(0),h=Object(O.a)(y,2),g=h[0],w=h[1],A=Object(o.useState)(0),T=Object(O.a)(A,2),P=T[0],k=T[1],x=Object(o.useState)(null),D=Object(O.a)(x,2),_=D[0],V=D[1];Object(o.useEffect)(()=>{window.onscroll=(e=>w(window.scrollY))},[]),Object(o.useEffect)(()=>{if(_)return;const e=new(window.AudioContext||window.webkitAudioContext);e.createPulseOscillator=wt,e.createVoltToHzConverter=kt,V(e)},[_,c]);const N=Object(o.useCallback)(e=>{n&&s({portId:"".concat(n.moduleId,"-").concat(n.portId),toPoint:{x:e.clientX,y:e.clientY+g}})},[s,n,g]),L=Object(o.useCallback)(e=>{m&&u(m,e.clientX,P)},[m,u,P]),B=Object(o.useCallback)(()=>{n&&(i("".concat(n.moduleId,"-").concat(n.portId)),r())},[r,i,n]),G=Object(o.useCallback)(e=>{N(e),L(e)},[N,L]),U=Object(o.useCallback)(e=>t=>{E(t?e:null)},[]),F=Object(o.useCallback)(e=>{C(e.target.scrollLeft)},[]);return a.a.createElement("div",{onMouseUp:B,onMouseMove:G,onScroll:F},a.a.createElement(ct,null),a.a.createElement(vt,null),a.a.createElement("div",null,a.a.createElement("div",{style:{overflowX:"scroll"}},t.map((t,n)=>a.a.createElement("div",{key:n,className:"rack",style:{width:"calc(100% + ".concat(f,"px)")},onMouseEnter:()=>k(n)},_&&t.map(t=>{const o=e[t],c=o.Module,r=o.width,l=o.left;return a.a.createElement(gt,{key:t,rackId:n,moduleId:t,setDragging:U(t),dragging:t===m,width:r,left:l},a.a.createElement(c,{id:t,audioContext:_}))})))),a.a.createElement(ut,{scrollLeft:f,scrollTop:g,height:1.5*t.length*370})))},Dt=n(27),Mt=n(53);n(81);Dt.b.add(Mt.a);var Rt=class extends o.Component{render(){return a.a.createElement(l.a,{store:at},a.a.createElement("div",{className:"App"},a.a.createElement(xt,null)))}};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(a.a.createElement(Rt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(e=>{e.unregister()})}},[[56,1,2]]]);
//# sourceMappingURL=main.277deb8a.chunk.js.map