(this.webpackJsonpmodularsynthjs=this.webpackJsonpmodularsynthjs||[]).push([[0],{152:function(e,t,n){e.exports=n.p+"static/media/screw_header.2c2805d6.svg"},153:function(e,t,n){},154:function(e,t,n){},155:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(22),c=n.n(r),u=(n(86),n(62)),i=n(63),l=n(79),d=n(76),s=n(9),f=n(27),p=n(65),m=n(10),v=n(3),b=n(180),O=n(21),h=n(68),E=n(4),g=n(162),j=n(185),I=n(16),w=n(78),y=n(44),C=n(157),S=n(158),T=n(186),x=function(e){return{type:"ADD_CABLE",portId:e.portId,fromPoint:e.fromPoint,color:e.color}},A=function(e){return{type:"MODIFY_CABLE",portId:e.portId,fromPoint:e.fromPoint,toPoint:e.toPoint,toPortId:e.toPortId}},M=function(e){return{type:"REMOVE_CABLE",portId:e}},P=function(e){return{type:"CHANGE_OVER_PORT",portId:e}},R=function(e){return{type:"ADD_MODULE",module:e}},k=function(e){return{type:"CONNECT_MODULES",output:e.output,input:e.input}},V=function(e){return{type:"DISCONNECT_MODULE",port:e}},D=function(e,t){return{type:"REGISTER_INPUTS",id:e,inputs:t}},L=function(e,t){return{type:"REGISTER_OUTPUTS",id:e,outputs:t}},_=function(e){return{type:"SET_STARTING_PORT",port:e}},G=function(){return{type:"UNSET_STARTING_PORT"}},N=function(e,t,n){return{type:"MOVE_MODULE",moduleId:e,x:t,rackId:n}},B=function(e){return function(t,n){var a=n(),o=a.modules,r=o.modules,c=o.connections,u=a.cables.cables,i=r[e];if(i){var l=j.a(I.a,w.a((function(t){return y.a([e,t],c)})),C.a((function(n){t(V({moduleId:e,portId:n}));var a="".concat(e,"-").concat(n);u[a]||(a=j.a(w.a(S.a("toPortId",a)),I.a,T.a)(u)),t(M(a))})));i.inputs&&l(i.inputs),i.outputs&&l(i.outputs),t({type:"REMOVE_MODULE",moduleId:e})}}},F=n(159),U=n(187),W=n(188),z=n(160),q=n(66),H=n.n(q),Y=n(45),K=n.n(Y);n(92);function X(e){var t=Object(s.b)();return Object(a.useCallback)(j.a(e,t),[e,t])}var J={HIDE:"HIDE",ABOVE:"ABOVE",BELOW:"BELOW",LEFT:"LEFT",RIGHT:"RIGHT"},Q=function(e){var t=e.label,r=e.labelPosition,c=void 0===r?J.ABOVE:r,u=e.portId,i=e.moduleId,l=e.portType,d=Object(s.c)(y.a(["modules","startingPort"])),f=Object(s.c)(y.a(["modules","connections",i,u])),p=Object(s.c)(j.a(y.a(["cables","cables"]),F.a)),m=X(k),b=X(V),O=X(_),h=X(G),E=X(x),g=X(M),I=X(A),w=X(P),C=Object(a.useMemo)((function(){return"".concat(i,"-").concat(u)}),[i,u]),S=Object(a.useRef)(null);Object(a.useEffect)((function(){var e=U.a(W.a({portId:C}),p);if(e){var t=S.current.getBoundingClientRect(),n=t.x,a=t.y,o=t.width,r=t.height;I({portId:e.portId,fromPoint:{x:n+o/2,y:a+window.scrollY+r/2}})}else{var c=U.a(W.a({toPortId:C}),p);if(c){var u=S.current.getBoundingClientRect(),i=u.x,l=u.y,d=u.width,s=u.height;I({portId:c.portId,toPoint:{x:i+d/2,y:l+window.scrollY+s/2}})}}}),[f]);var T=z.a(t)?u:t;return o.a.createElement("div",{className:H()("port",{disabled:d&&d.portType===l}),onMouseDown:function(e){e.stopPropagation();var t={portId:u,portType:l,moduleId:i};f&&(b({moduleId:i,portId:u}),g("".concat(f.moduleId,"-").concat(f.portId))),O(t);var n=S.current.getBoundingClientRect(),a=n.x,o=n.y,r=n.width,c=n.height;E({portId:C,fromPoint:{x:a+r/2,y:o+window.scrollY+c/2},color:K()({luminosity:"dark"})})},onMouseUp:function(e){var t;if(h(),d&&d.portType!==l&&(d.moduleId!==i||d.id!==u)){e.stopPropagation();var n=S.current.getBoundingClientRect(),a=n.x,o=n.y,r=n.width,c=n.height;!f||f.moduleId===d.moduleId&&f.portId===d.portId||(g("".concat(f.moduleId,"-").concat(f.portId)),g(C)),I({portId:"".concat(d.moduleId,"-").concat(d.portId),toPoint:{x:a+r/2,y:o+c/2},toPortId:C}),m((t={},Object(v.a)(t,d.portType,d),Object(v.a)(t,l,{moduleId:i,portId:u}),t))}}},c===J.ABOVE&&T,o.a.createElement("img",{id:C,height:"30",width:"30",ref:S,onMouseEnter:function(){return w(C)},onMouseLeave:function(){return w(null)},onMouseDown:function(e){return e.preventDefault()},src:n(93),alt:C}),c===J.BELOW&&T)},$=function(e){var t=e.onChange,r=e.max,c=e.min,u=e.value,i=e.step,l=e.label,d=e.labelPosition,s=void 0===d?J.ABOVE:d,f=e.height,p=void 0===f?50:f,m=e.width,v=void 0===m?50:m,b=Object(a.useState)(!1),O=Object(E.a)(b,2),h=O[0],g=O[1],j=Object(a.useRef)(null),I=Object(a.useCallback)((function(e){if(h&&(e.stopPropagation(),e.preventDefault(),1===e.buttons)){var n=j.current.getBoundingClientRect(),a=n.x,o=n.y,u=a+n.width/2,l=o+n.height/2,d=e.clientX-u,s=e.clientY-l,f=180*Math.atan2(s,d)/Math.PI;f<0&&(f+=360),(f-=120)<0&&(f+=360),f>315&&(f=0);var p=f/300*(r-c)+c;(p=Math.floor(p/i)*i)>r&&(p=r),t(p)}}),[h,c,r,t,i]),w=Object(a.useCallback)((function(e){e.stopPropagation(),g(!0)}),[]),y=Object(a.useCallback)((function(){g(!1)}),[]),C=Object(a.useCallback)((function(){return 2*((u-c)/(r-c))*150}),[c,r,u]);return Object(a.useEffect)((function(){return document.addEventListener("mouseup",y),document.addEventListener("mousemove",I),function(){document.removeEventListener("mouseup",y),document.removeEventListener("mousemove",I)}}),[y,I]),o.a.createElement("div",{style:{display:"flex",flexDirection:s===J.RIGHT||s===J.LEFT?"row":"column"}},(s===J.ABOVE||s===J.LEFT)&&l,o.a.createElement("img",{ref:j,style:{cursor:"pointer",margin:"auto",transform:"rotate(".concat(C(),"deg)")},onMouseDown:w,alt:"knob",src:n(94),height:p,width:v}),(s===J.BELOW||s===J.RIGHT)&&l)},Z=n(6),ee=n(7),te=n(161);function ne(){var e=Object(Z.a)(["\n    grid-column: ",";\n    grid-row: ",";\n"]);return ne=function(){return e},e}function ae(){var e=Object(Z.a)(["\n    display: grid;\n    flex: 1;\n    grid-template-rows: ",";\n    margin-top: ","px;\n    margin-bottom: ","px;\n    margin-left: ","px;\n    margin-right: ","px;\n"]);return ae=function(){return e},e}function oe(){var e=Object(Z.a)(["\n    display: flex;\n    justify-content: space-around;\n"]);return oe=function(){return e},e}function re(){var e=Object(Z.a)(["\n    display: flex;\n    flex-direction: column;\n    flex: 1;\n    justify-content: space-evenly;\n"]);return re=function(){return e},e}function ce(){var e=Object(Z.a)(["\n    display: flex;\n    flex-direction: column;\n    height: 100%\n"]);return ce=function(){return e},e}var ue=ee.b.div(ce()),ie=ee.b.div(re()),le=ee.b.div(oe()),de=ee.b.div(ae(),Object(te.a)("gridTemplateRows"),Object(te.a)("marginTop"),Object(te.a)("marginBottom"),Object(te.a)("marginLeft"),Object(te.a)("marginRight")),se=ee.b.div(ne(),Object(te.a)("column"),Object(te.a)("row")),fe={container:{display:"flex",flexDirection:"column",height:"100%"},body:{display:"flex",flexDirection:"column",flex:1,justifyContent:"space-evenly"},spaceAround:{display:"flex",justifyContent:"space-around"}},pe=function(e,t){var n=e.createOscillator();return n.type=t,n.frequency.value=0,n},me={Sawtooth:"Sawtooth",Pulse:"Pulse",Triangle:"Triangle",Sine:"Sine"},ve=function(e){var t=e.id,r=e.audioContext,c=e.viewMode,u=X(D),i=X(L),l=Object(a.useState)(0),d=Object(E.a)(l,2),s=d[0],f=d[1],p=Object(a.useState)(0),m=Object(E.a)(p,2),v=m[0],b=m[1],h=Object(a.useState)(0),w=Object(E.a)(h,2),y=w[0],C=w[1],S=Object(a.useState)(0),T=Object(E.a)(S,2),x=T[0],A=T[1],M=Object(a.useState)(0),P=Object(E.a)(M,2),R=P[0],k=P[1],V=Object(a.useMemo)((function(){if(c)return null;var e=r.createPulseOscillator();e.frequency.value=0,e.width.value=0;var t={Sawtooth:pe(r,"sawtooth"),Pulse:e,Triangle:pe(r,"triangle"),Sine:pe(r,"sine")},n=r.createVoltToHzConverter(440,4),a=r.createConstantSource();n.volt.value=0,a.offset.value=0;var o=r.createGain();o.gain.value=0,o.connect(n.volt),g.a((function(e){return n.connect(e.frequency)}))(t),g.a((function(e){return a.connect(e.detune)}))(t);var u=r.createGain();return u.gain.value=0,u.connect(t.Pulse.width),g.a((function(e){return e.start()}))(t),n.start(),a.start(),{oscillators:t,frequencyControl:n,detuneControl:a,cv2Gain:o,pwCvGain2:u}}),[r,c]);Object(a.useEffect)((function(){V&&(u(t,{CV1:{connect:function(e){return e.connect(V.frequencyControl.volt)},disconnect:function(e){return e.disconnect(V.frequencyControl.volt)}},PWCV1:{connect:function(e){return e.connect(V.oscillators.Pulse.width)},disconnect:function(e){return e.disconnect(V.oscillators.Pulse.width)}},PWCV2:{connect:function(e){return e.connect(V.pwCvGain2)},disconnect:function(e){return e.disconnect(V.pwCvGain2)}},CV2:{connect:function(e){return e.connect(V.cv2Gain)},disconnect:function(e){return e.disconnect(V.cv2Gain)}}}),i(t,{Sawtooth:V.oscillators.Sawtooth,Pulse:V.oscillators.Pulse,Triangle:V.oscillators.Triangle,Sine:V.oscillators.Sine}))}),[V,t,u,i]);var _=Object(a.useCallback)((function(e){f(e),V.frequencyControl.volt.value=e}),[V]),G=Object(a.useCallback)((function(e){b(e),V.detuneControl.offset.value=e}),[V]),N=Object(a.useCallback)((function(e){C(e),V.oscillators.Pulse.width.value=e}),[V]),B=Object(a.useCallback)((function(e){A(e),V.pwCvGain2.gain.value=e}),[V]),F=Object(a.useCallback)((function(e){k(e),V.cv2Gain.gain.value=e}),[V]);return o.a.createElement(ue,null,o.a.createElement("span",{style:{marginBottom:4}},"VCO"),o.a.createElement(ie,null,o.a.createElement(de,{gridTemplateRows:"22px auto"},o.a.createElement(se,{column:1,row:2},o.a.createElement(Q,{portId:"CV1",moduleId:t,portType:"input"})),o.a.createElement(se,{column:1,row:3},o.a.createElement(Q,{portId:"CV2",moduleId:t,portType:"input"})),o.a.createElement(se,{column:1,row:4},o.a.createElement(Q,{portId:"PWCV1",moduleId:t,portType:"input"})),o.a.createElement(se,{column:1,row:5},o.a.createElement(Q,{portId:"PWCV2",moduleId:t,portType:"input"})),o.a.createElement(se,{column:2,row:1},o.a.createElement($,{label:"Range",labelPosition:J.RIGHT,min:-4,max:4,step:1,value:s,width:20,height:20,onChange:_})),o.a.createElement(se,{column:"2/4",row:2},o.a.createElement($,{label:"Tune",min:-600,max:600,step:1,value:v,width:30,height:30,onChange:G})),o.a.createElement(se,{column:"2/4",row:3},o.a.createElement($,{label:"CV2",min:0,max:1,step:.005,value:R,width:30,height:30,onChange:F})),o.a.createElement(se,{column:"2/4",row:4},o.a.createElement($,{label:"PW",min:-1,max:1,step:.001,value:y,width:30,height:30,onChange:N})),o.a.createElement(se,{column:"2/4",row:5},o.a.createElement($,{label:"PW CV2",min:0,max:1,step:.005,value:x,width:30,height:30,onChange:B}))),o.a.createElement(le,null,j.a(I.a,O.a((function(e){return o.a.createElement(Q,{key:e,label:o.a.createElement("img",{width:25,src:n(60)("./".concat(e.toLowerCase(),".svg")),alt:e}),labelPosition:J.BELOW,portId:e,moduleId:t,portType:"output"})})))(me))))};ve.isBrowserSupported="undefined"!==typeof OscillatorNode&&"undefined"!==typeof ConstantSourceNode,ve.panelWidth=10,ve.title="\nStandard VCO<br/>\nVoltage Controlled Oscillator<br/>\nIt can produce four waveforms simultaneously:<br/>\nrectangle, sawtooth, triangle, and sine wave\n";var be=ve;function Oe(e){return Object(s.c)(y.a(["modules","connections",e]))}var he=function(e){var t=e.id,n=e.audioContext,r=e.viewMode,c=Oe(t),u=X(D),i=Object(a.useMemo)((function(){if(r)return null;var e=new StereoPannerNode(n,{pan:-1}),t=new StereoPannerNode(n,{pan:1});return e.connect(n.destination),t.connect(n.destination),{leftPanner:e,rightPanner:t}}),[n,r]);return Object(a.useEffect)((function(){i&&u(t,{Left:{connect:function(e){return e.connect(i.leftPanner)},disconnect:function(e){return e.disconnect(i.leftPanner)}},Right:{connect:function(e){return e.connect(i.rightPanner)},disconnect:function(e){return e.disconnect(i.rightPanner)}}})}),[i,t,u]),o.a.createElement("div",{style:fe.container},o.a.createElement("span",null,"Stereo"),o.a.createElement("div",{style:fe.body},o.a.createElement(Q,{portId:"Left",connections:c,moduleId:t,portType:"input"}),o.a.createElement(Q,{portId:"Right",connections:c,moduleId:t,portType:"input"})))};he.isBrowserSupported="undefined"!==typeof StereoPannerNode,he.panelWidth=4,he.title="\nStereo Audio Interface<br/>\nSends stereo audio to the computer's audio interface\n";var Ee=he,ge=function(e){var t=e.id,n=e.audioContext,r=e.viewMode,c=Oe(t),u=X(D);return Object(a.useEffect)((function(){r||u(t,{In:{connect:function(e){return e.connect(n.destination)},disconnect:function(e){return e.disconnect(n.destination)}}})}),[t,u,n,r]),o.a.createElement("div",{style:fe.container},o.a.createElement("span",null,"Mono"),o.a.createElement("div",{style:fe.body},o.a.createElement(Q,{portId:"In",connections:c,moduleId:t,portType:"input"})))};ge.isBrowserSupported=!0,ge.panelWidth=4,ge.title="\nMono Audio Interface<br/>\nSends audio to the computer's audio interface\n";var je=ge,Ie=n(163),we=n(189);function ye(){var e=Object(Z.a)(["left: ","px;"]);return ye=function(){return e},e}function Ce(){var e=Object(Z.a)(["top: ","px;"]);return Ce=function(){return e},e}function Se(){var e=Object(Z.a)(["        \n    width: ","px;\n    height: ","px;\n    background-color: gray;\n    position: absolute;\n    transition: "," .2s;\n    ","\n"]);return Se=function(){return e},e}function Te(){var e=Object(Z.a)(["\n    background-color: black;\n    width: ","px;\n    height: ","px;\n    cursor: pointer;\n    position: relative;\n"]);return Te=function(){return e},e}function xe(){var e=Object(Z.a)(["\n    font-size: 10px; \n    flex: 1;\n"]);return xe=function(){return e},e}function Ae(){var e=Object(Z.a)(["width: ","px;"]);return Ae=function(){return e},e}function Me(){var e=Object(Z.a)(["height: ","px;"]);return Me=function(){return e},e}function Pe(){var e=Object(Z.a)(["\n    display: flex;\n    flex-direction: ",";\n    justify-content: space-between;\n    ","\n"]);return Pe=function(){return e},e}function Re(){var e=Object(Z.a)(["\n    display: flex;\n    flex-direction: ",";\n    align-items: center;\n    justify-content: center;\n"]);return Re=function(){return e},e}var ke=ee.b.div(Re(),(function(e){return e.vertical?"row":"column"})),Ve=ee.b.div(Pe(),(function(e){return e.vertical?"column":"row"}),(function(e){var t=e.vertical,n=e.size;return t?Object(ee.a)(Me(),n+10):Object(ee.a)(Ae(),n+10)})),De=ee.b.span(xe()),Le=ee.b.div(Te(),(function(e){var t=e.vertical,n=e.size;return t?10:n}),(function(e){var t=e.vertical,n=e.size;return t?n:10})),_e=ee.b.div(Se(),(function(e){var t=e.vertical,n=e.handlerSize;return t?10:n}),(function(e){var t=e.vertical,n=e.handlerSize;return t?n:10}),(function(e){return e.vertical?"top":"left"}),(function(e){var t=e.vertical,n=e.position;return t?Object(ee.a)(Ce(),n):Object(ee.a)(ye(),n)})),Ge=function(e){var t=e.value,n=e.onChange,r=e.options,c=e.vertical,u=void 0!==c&&c,i=e.size,l=void 0===i?30:i,d=e.handlerSize,s=void 0===d?5:d,f=Object(a.useState)(0),p=Object(E.a)(f,2),m=p[0],v=p[1],b=Object(a.useState)(!1),O=Object(E.a)(b,2),h=O[0],g=O[1],j=Object(a.useRef)(null),I=Object(a.useMemo)((function(){for(var e=[s/2],t=1;t<r.length-1;t++)e.push(l/(r.length-1)*t);return e.push(l-s/2),e}),[r,l,s]);Object(a.useEffect)((function(){var e=we.a(W.a({value:t}),r)*(l/(r.length-1))-s/2;e=Math.min(Math.max(0,e),l-s),v(e)}),[t,r,l,s]);var w=Object(a.useCallback)((function(e){var t=e[u?"clientY":"clientX"]-j.current.getBoundingClientRect()[u?"y":"x"],a=we.a((function(e){return Math.abs(t-e)<=s/2}),I);-1!==a&&n(r[a].value)}),[I,s,n,r,u]),y=Object(a.useCallback)((function(e){e.stopPropagation(),w(e)}),[w]),C=Object(a.useCallback)((function(e){e.stopPropagation(),g(!0)}),[]),S=Object(a.useCallback)((function(){g(!1)}),[]),T=Object(a.useCallback)((function(e){h&&(e.stopPropagation(),e.preventDefault(),w(e))}),[h,w]);return Object(a.useEffect)((function(){return document.addEventListener("mouseup",S),document.addEventListener("mousemove",T),function(){document.removeEventListener("mouseup",S),document.removeEventListener("mousemove",T)}}),[S,T]),o.a.createElement(ke,{vertical:u},o.a.createElement(Ve,{size:l,vertical:u},r.map((function(e){var t=e.value,n=e.label;return o.a.createElement(De,{key:t},n)}))),o.a.createElement(Le,{size:l,vertical:u,onMouseDown:y,ref:j},o.a.createElement(_e,{position:m,vertical:u,handlerSize:s,onMouseDown:C})))},Ne=[90,83,88,68,67,86,71,66,72,78,74,77,188],Be=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B","C"],Fe={"C#":"1/4","D#":"3/6","F#":"6/9","G#":"8/11","A#":"10/13"},Ue=function(e,t){return t-5+(e+3)/12},We=function(e){var t=e.id,n=e.audioContext,r=e.viewMode,c=Oe(t),u=X(L),i=Object(a.useState)(4),l=Object(E.a)(i,2),d=l[0],s=l[1],f=Object(a.useState)(0),p=Object(E.a)(f,2),m=p[0],v=p[1],b=Object(a.useState)(!1),O=Object(E.a)(b,2),h=O[0],g=O[1],j=Object(a.useMemo)((function(){if(r)return null;var e=n.createConstantSource();e.offset.value=0,e.start();var t=n.createConstantSource();return t.offset.value=0,t.start(),{gate:e,cv:t}}),[n,r]);Object(a.useEffect)((function(){j&&u(t,{CV:j.cv,Gate:j.gate})}),[t,j,u]),Object(a.useEffect)((function(){j&&(j.cv.offset.value=m)}),[j,m]);var I=Object(a.useCallback)((function(e){v(e),j.gate.offset.value=1}),[j]),w=Object(a.useCallback)((function(){j.gate.offset.value=0}),[j]),y=Object(a.useCallback)((function(e){var t=Ie.a(e.keyCode,Ne);h||-1===t||(g(!1),I(Ue(t,d)))}),[h,I,d]),C=Object(a.useCallback)((function(){g(!1),w()}),[w]);Object(a.useEffect)((function(){r||(document.onkeydown=y,document.onkeyup=C)}),[y,C]);var S=Object(a.useCallback)((function(e){var t=j.cv.offset.value;v(t+e-d),s(e)}),[j,d]);return o.a.createElement("div",{style:fe.container},o.a.createElement("span",null,"\xb5Keyboard"),o.a.createElement("div",{style:fe.body},"Octave",o.a.createElement(Ge,{value:d,onChange:S,size:60,options:[{value:2,label:"-2"},{value:3,label:"-1"},{value:4,label:"0"},{value:5,label:"+1"},{value:6,label:"+2"}]}),o.a.createElement("div",{style:{display:"grid",flex:1}},Be.map((function(e,t){var n=e.endsWith("#"),a=n?Fe[e]:t+1;return[o.a.createElement("div",{key:"TITLE_".concat(e).concat(t),style:{alignSelf:"center",gridRow:a,gridColumn:n?4:1}},e),o.a.createElement("button",{key:"".concat(e).concat(t),onMouseDown:function(e){e.stopPropagation(),I(Ue(t,d))},onMouseUp:w,style:{height:20,width:20,gridRow:a,alignSelf:"center",gridColumn:n?3:2,backgroundColor:n?"black":"white"}})]}))),o.a.createElement("div",{style:fe.spaceAround},o.a.createElement(Q,{portId:"CV",connections:c,moduleId:t,portType:"output"}),o.a.createElement(Q,{portId:"Gate",connections:c,moduleId:t,portType:"output"}))))};We.isBrowserSupported="undefined"!==typeof ConstantSourceNode,We.panelWidth=8,We.title="\nMicro Keyboard<br/>\n1 octave micro keyboard and a five-position octave switch.<br/>\nUsed to generate 1V/Octave CV signal.\n";var ze=We,qe="LOW",He="MEDIUM",Ye="HIGH",Ke=function(e,t){switch(t){case qe:return 1e-4*Math.pow(e,4)+1e-6;case He:return 2*Math.pow(e,4)+401e-6;case Ye:default:return 120*Math.pow(e,4)+.020001}},Xe=function(e){var t=e.id,n=e.audioContext,r=e.viewMode,c=Oe(t),u=X(D),i=X(L),l=Object(a.useState)(0),d=Object(E.a)(l,2),s=d[0],f=d[1],p=Object(a.useState)(.5),m=Object(E.a)(p,2),v=m[0],b=m[1],O=Object(a.useState)(.5),h=Object(E.a)(O,2),g=h[0],j=h[1],I=Object(a.useState)(.5),w=Object(E.a)(I,2),y=w[0],C=w[1],S=Object(a.useState)(.5),T=Object(E.a)(S,2),x=T[0],A=T[1],M=Object(a.useState)(He),P=Object(E.a)(M,2),R=P[0],k=P[1],V=Object(a.useMemo)((function(){if(r)return null;var e=n.createConstantSource(),t=n.createConstantSource(),a=n.createGate(),o=n.createGate();return e.offset.value=0,e.start(),t.offset.value=0,t.start(),{adsr:e,inverese:t,gate:a,retrigger:o}}),[n,r]),_=Object(a.useCallback)((function(e){if(V){var t=Ke(v,R)+.01,a=Ke(g,R),o=Ke(x,R),r=n.currentTime,c=V.adsr.offset,u=V.inverese.offset;1===e?(c.cancelScheduledValues(r),c.setValueAtTime(c.value,r),c.linearRampToValueAtTime(1,r+t),c.linearRampToValueAtTime(y,r+t+a),u.cancelScheduledValues(r),u.setValueAtTime(u.value,r),u.linearRampToValueAtTime(-1,r+t),u.linearRampToValueAtTime(-1*y,r+t+a)):0===e&&(c.cancelScheduledValues(r),c.setValueAtTime(c.value,r),c.linearRampToValueAtTime(0,r+o),u.cancelScheduledValues(r),u.setValueAtTime(u.value,r),u.linearRampToValueAtTime(0,r+o))}}),[V,v,g,y,x,n,R]),G=Object(a.useCallback)((function(e){f(e),_(e)}),[_]),N=Object(a.useCallback)((function(e){1===s&&_(e)}),[s,_]);return Object(a.useEffect)((function(){V&&(V.gate.gateChange=G)}),[V,G]),Object(a.useEffect)((function(){V&&(V.retrigger.gateChange=N)}),[V,N]),Object(a.useEffect)((function(){V&&(window.adsr=V,u(t,{Gate:{connect:function(e){return e.connect(V.gate)},disconnect:function(e){return e.disconnect(V.gate)}},Retrigger:{connect:function(e){return e.connect(V.retrigger)},disconnect:function(e){return e.disconnect(V.retrigger)}}}),i(t,{Out1:V.adsr,Out2:V.adsr,Inverse:V.inverese}))}),[V,u,i,t]),o.a.createElement(ue,null,o.a.createElement("span",null,"ADSR"),o.a.createElement(de,null,o.a.createElement(se,{column:1,row:1},o.a.createElement(Q,{portId:"Gate",connections:c,moduleId:t,portType:"input"})),o.a.createElement(se,{column:1,row:2},o.a.createElement(Q,{label:"Retrig.",portId:"Retrigger",connections:c,moduleId:t,portType:"input"})),o.a.createElement(se,{column:1,row:3},o.a.createElement(Q,{label:"Output",portId:"Out1",connections:c,moduleId:t,portType:"output"})),o.a.createElement(se,{column:1,row:4},o.a.createElement(Q,{label:"Output",portId:"Out2",connections:c,moduleId:t,portType:"output"})),o.a.createElement(se,{column:1,row:5},o.a.createElement(Q,{label:"Inverse Output",portId:"Inverse",connections:c,moduleId:t,portType:"output"})),o.a.createElement(se,{column:2,row:1},o.a.createElement($,{min:0,max:1,step:.001,value:v,label:"A",onChange:b,width:30,height:30})),o.a.createElement(se,{column:2,row:2},o.a.createElement($,{min:0,max:1,step:.001,value:g,label:"D",onChange:j,width:30,height:30})),o.a.createElement(se,{column:2,row:3},o.a.createElement($,{min:0,max:1,step:.01,value:y,label:"S",onChange:C,width:30,height:30})),o.a.createElement(se,{column:2,row:4},o.a.createElement($,{min:0,max:1,step:.001,value:x,label:"R",onChange:A,width:30,height:30})),o.a.createElement(se,{column:2,row:5},o.a.createElement(Ge,{value:R,onChange:k,options:[{value:qe,label:"L"},{value:He,label:"M"},{value:Ye,label:"H"}]}),"Time",o.a.createElement("br",null),"Range")))};Xe.isBrowserSupported="undefined"!==typeof ConstantSourceNode,Xe.panelWidth=8,Xe.title="\nADSR<br/>\nEnvelope Generator<br/>\nThe shape of the envelope is governed by four parameters:<br/>\nAttack, Decay, Sustain and Release.<br/>\nAs soon as the gate input receives sufficient voltage,<br/>\nthe ADSR generates a variable voltage, changing in time, called an envelope.\n";var Je=Xe,Qe=function(e){var t=e.id,n=e.audioContext,r=e.viewMode,c=Oe(t),u=X(D),i=X(L),l=Object(a.useState)(1),d=Object(E.a)(l,2),s=d[0],f=d[1],p=Object(a.useState)(0),v=Object(E.a)(p,2),b=v[0],O=v[1],h=Object(a.useState)(1),g=Object(E.a)(h,2),j=g[0],I=g[1],w=Object(a.useState)(1),y=Object(E.a)(w,2),C=y[0],S=y[1],T=Object(a.useState)(1),x=Object(E.a)(T,2),A=x[0],M=x[1],P=Object(a.useMemo)((function(){if(r)return null;var e=n.createGain(),t=n.createGain(),a=n.createGain(),o=n.createGain(),c=n.createConstantSource(),u=n.createGain(),i=n.createGain();return a.connect(e),o.connect(e),c.offset.value=0,c.start(),c.connect(u),u.gain.value=0,u.connect(e.gain),e.connect(t).connect(i),{input1Gain:a,input2Gain:o,cv2:c,cv2Gain:u,gainVolume:t,outputGain:i,gain:e}}),[n,r]);return Object(a.useEffect)((function(){P&&(window.vca=P,u(t,{AudioIn1:{connect:function(e){return e.connect(P.input1Gain)},disconnect:function(e){return e.disconnect(P.input1Gain)}},AudioIn2:{connect:function(e){return e.connect(P.input2Gain)},disconnect:function(e){return e.disconnect(P.input2Gain)}},CV1:{connect:function(e){return P.gain.gain.linearRampToValueAtTime(0,n.currentTime+.01),e.connect(P.gain.gain)},disconnect:function(e){P.gain.gain.linearRampToValueAtTime(1,n.currentTime+.01),e.disconnect(P.gain.gain),e.offset&&(e.offset.value=0)}},CV2:{connect:function(e){return P.gain.gain.linearRampToValueAtTime(0,n.currentTime+.01),e.connect(P.cv2.offset)},disconnect:function(e){P.gain.gain.linearRampToValueAtTime(1,n.currentTime+.01),e.disconnect(P.cv2.offset),e.offset&&(e.offset.value=0)}}}),i(t,{AudioOut:P.outputGain}))}),[P,t,u,i,n]),Object(a.useEffect)((function(){P&&(P.gainVolume.gain.value=s)}),[P,s]),Object(a.useEffect)((function(){P&&(P.cv2Gain.gain.value=b)}),[P,b]),Object(a.useEffect)((function(){P&&(P.input1Gain.gain.value=j)}),[P,j]),Object(a.useEffect)((function(){P&&(P.input2Gain.gain.value=C)}),[P,C]),Object(a.useEffect)((function(){P&&(P.outputGain.gain.value=A)}),[P,A]),o.a.createElement("div",{style:fe.container},o.a.createElement("span",null,"VCA"),o.a.createElement("div",{style:Object(m.a)({},fe.spaceAround,{flex:1})},o.a.createElement("div",{style:Object(m.a)({},fe.spaceAround,{flexDirection:"column"})},o.a.createElement(Q,{portId:"CV1",connections:c,moduleId:t,portType:"input"}),o.a.createElement(Q,{portId:"CV2",connections:c,moduleId:t,portType:"input"}),o.a.createElement(Q,{portId:"AudioIn1",connections:c,moduleId:t,portType:"input"}),o.a.createElement(Q,{portId:"AudioIn2",connections:c,moduleId:t,portType:"input"}),o.a.createElement(Q,{portId:"AudioOut",connections:c,moduleId:t,portType:"output"})),o.a.createElement("div",{style:Object(m.a)({},fe.spaceAround,{flexDirection:"column"})},"Gain",o.a.createElement($,{min:0,max:2,step:.02,value:s,width:30,height:30,onChange:f}),"CV 2",o.a.createElement($,{min:0,max:1,step:.01,value:b,width:30,height:30,onChange:O}),"In 1",o.a.createElement($,{min:0,max:1,step:.01,value:j,width:30,height:30,onChange:I}),"In 2",o.a.createElement($,{min:0,max:1,step:.01,value:C,width:30,height:30,onChange:S}),"Out",o.a.createElement($,{min:0,max:1,step:.01,value:A,width:30,height:30,onChange:M}))))};Qe.isBrowserSupported="undefined"!==typeof GainNode,Qe.panelWidth=8,Qe.title="\nLinear VCA<br/>\nVoltage Controlled Amplifiers<br/>\nThe VCA has two audio inputs, each with an attenuator.<br/>\nThey are amplified by an amount determined<br/>\nby the combination of the gain and the two CV controls.\n";var $e=Qe,Ze=function(e){var t=e.id,n=e.audioContext,r=e.viewMode,c=Oe(t),u=X(D),i=X(L),l=Object(a.useState)(.5),d=Object(E.a)(l,2),s=d[0],f=d[1],p=Object(a.useState)(.1),v=Object(E.a)(p,2),b=v[0],O=v[1],h=Object(a.useState)(.5),g=Object(E.a)(h,2),j=g[0],I=g[1],w=Object(a.useState)(.5),y=Object(E.a)(w,2),C=y[0],S=y[1],T=Object(a.useMemo)((function(){if(r)return null;var e=n.createBiquadFilter(),t=n.createVoltToHzConverter(440,2),a=n.createVoltToHzConverter(440,2),o=n.createVoltToHzConverter(440,2),c=n.createGain(),u=n.createGain();return t.volt.value=0,t.start(),t.connect(e.frequency),a.volt.value=0,a.start(),a.connect(c),c.gain.value=.5,c.connect(e.frequency),o.volt.value=0,o.start(),o.connect(u),u.gain.value=.5,u.connect(e.frequency),e.type="lowpass",e.Q.value=.5,{vcf:e,cv:t,cv2:a,cv3:o,cv2Gain:c,cv3Gain:u}}),[n,r]);Object(a.useEffect)((function(){T&&(window.vcf=T,u(t,{In:{connect:function(e){return e.connect(T.vcf)},disconnect:function(e){return e.disconnect(T.vcf)}},CV1:{connect:function(e){return e.connect(T.cv.volt)},disconnect:function(e){return e.disconnect(T.cv.volt)}},CV2:{connect:function(e){return e.connect(T.cv2.volt)},disconnect:function(e){return e.disconnect(T.cv2.volt)}},CV3:{connect:function(e){return e.connect(T.cv3.volt)},disconnect:function(e){return e.disconnect(T.cv3.volt)}}}),i(t,{Out:T.vcf}))}),[T,t,u,i]),Object(a.useEffect)((function(){if(T){var e=n.sampleRate/2,t=Math.log(e/40)/Math.LN2,a=Math.pow(2,t*(s-1));T.vcf.frequency.setValueAtTime(e*a,n.currentTime)}}),[T,s,n]);var x=Object(a.useCallback)((function(e){f(Number(e))}),[]);Object(a.useEffect)((function(){T&&(T.vcf.Q.value=30*b)}),[T,b]);var A=Object(a.useCallback)((function(e){O(Number(e))}),[]);Object(a.useEffect)((function(){T&&(T.cv2Gain.gain.value=j)}),[T,j]);var M=Object(a.useCallback)((function(e){I(Number(e))}),[]);Object(a.useEffect)((function(){T&&(T.cv3Gain.gain.value=C)}),[T,C]);var P=Object(a.useCallback)((function(e){S(Number(e))}),[]);return o.a.createElement("div",{style:{display:"flex",flexDirection:"column",height:"100%"}},o.a.createElement("span",{style:{display:"flex",flexDirection:"column"}},"VCF",o.a.createElement("span",{style:{fontSize:10}},"LOW PASS FILTER")),o.a.createElement("div",{style:Object(m.a)({},fe.spaceAround,{flex:1})},o.a.createElement("div",{style:Object(m.a)({},fe.spaceAround,{flexDirection:"column"})},o.a.createElement(Q,{portId:"CV1",connections:c,moduleId:t,portType:"input"}),o.a.createElement(Q,{portId:"CV2",connections:c,moduleId:t,portType:"input"}),o.a.createElement(Q,{portId:"CV3",connections:c,moduleId:t,portType:"input"}),o.a.createElement(Q,{portId:"In",connections:c,moduleId:t,portType:"input"}),o.a.createElement(Q,{portId:"Out",connections:c,moduleId:t,portType:"output"})),o.a.createElement("div",{style:Object(m.a)({},fe.spaceAround,{flexDirection:"column"})},"Frequency",o.a.createElement($,{min:0,max:1,step:.01,value:s,width:30,height:30,onChange:function(e){return x(e)}}),"CV 2",o.a.createElement($,{min:0,max:1,step:.01,value:j,width:30,height:30,onChange:function(e){return M(e)}}),"CV 3",o.a.createElement($,{min:0,max:1,step:.01,value:C,width:30,height:30,onChange:function(e){return P(e)}}),"Res",o.a.createElement($,{min:0,max:1,step:.01,value:b,width:30,height:30,onChange:function(e){return A(e)}}))))};Ze.isBrowserSupported="undefined"!==typeof BiquadFilterNode,Ze.panelWidth=8,Ze.title="\nVCF<br/>\nLow-Pass Filter<br/>\nfilters out the higher parts of the sound spectrum,<br/>\nand lets lower frequencies pass through.\n";var et=Ze,tt=function(e){var t=e.id,n=e.viewMode,r=Oe(t),c=X(D),u=X(L),i=Object(a.useState)({A:null,B:null}),l=Object(E.a)(i,2),d=l[0],s=l[1],f=Object(a.useMemo)((function(){if(n)return null;return{groupA:{input:null,audioNode:null},groupB:{input:null,audioNode:null}}}),[n]);Object(a.useEffect)((function(){if(f){var e=function(e){for(var t={},n=f["group".concat(e)],a=function(a){t["Group".concat(e).concat(a,"In")]={connect:function(t){s(Object(m.a)({},d,Object(v.a)({},e,a))),n.input=a,n.audioNode=t},disconnect:function(){s(Object(m.a)({},d,Object(v.a)({},e,null))),n.audioNode=null}}},o=1;o<=4;o++)a(o);return t},n=function(e){for(var t={},n=1;n<=4;n++)t["Group".concat(e).concat(n,"Out")]=function(){return f["group".concat(e)].audioNode};return t};c(t,Object(m.a)({},e("A"),{},e("B"))),u(t,Object(m.a)({},n("A"),{},n("B")))}}),[f,t,c,u,d]);var p=Object(a.useCallback)((function(e){for(var n=[],a=1;a<=4;a++){var c=z.a(d[e])||d[e]===a,u={key:"Group".concat(e).concat(a),portId:"Group".concat(e).concat(a).concat(c?"In":"Out"),connections:r,moduleId:t,portType:c?"input":"output",labelPosition:J.HIDE};n.push(o.a.createElement(Q,u))}return n}),[d,r,t]);return o.a.createElement("div",{style:fe.container},o.a.createElement("span",{style:{fontSize:13}},"Multiples"),o.a.createElement("div",{style:fe.body},o.a.createElement("div",null,p("A")),o.a.createElement("div",null,p("B"))))};tt.isBrowserSupported="undefined"!==typeof ConstantSourceNode,tt.panelWidth=4,tt.title="\nMultiples<br/>\nSimple multi-connectors.<br/>\nCome as two four-fold multiples.\n";var nt=tt,at=n(164),ot=n(190),rt=n(31),ct=n(55),ut=function(e,t){var n=e.createOscillator();return n.type=t,n.frequency.value=0,n},it="LOW",lt="MEDIUM",dt="HIGH",st=at.a(O.a),ft={Sawtooth:"Sawtooth",RevSawtooth:"RevSawtooth",Sine:"Sine",Triangle:"Triangle",Pulse:"Pulse"},pt=function(e){var t=e.id,r=e.audioContext,c=e.viewMode,u=X(L),i=Object(a.useState)(0),l=Object(E.a)(i,2),d=l[0],s=l[1],f=Object(a.useState)(it),p=Object(E.a)(f,2),m=p[0],b=p[1],O=Object(a.useMemo)((function(){var e;if(c)return null;var t=r.createPulseOscillator();t.frequency.value=0,t.width.value=0;var n=(e={},Object(v.a)(e,ft.Sawtooth,ut(r,"sawtooth")),Object(v.a)(e,ft.RevSawtooth,ut(r,"sine")),Object(v.a)(e,ft.Sine,ut(r,"sine")),Object(v.a)(e,ft.Triangle,ut(r,"triangle")),Object(v.a)(e,ft.Pulse,t),e),a=r.createPeriodicWave(ct.DroppedSaw.real,ct.DroppedSaw.imag);n[ft.RevSawtooth].setPeriodicWave(a);var o=r.createConstantSource();return o.offset.value=0,g.a((function(e){return o.connect(e.frequency)}))(n),g.a((function(e){return e.start()}))(n),o.start(),{oscillators:n,frequencyControl:o}}),[r,c]);return Object(a.useEffect)((function(){var e;O&&u(t,(e={Sawtooth:O.oscillators.Sawtooth},Object(v.a)(e,ft.RevSawtooth,O.oscillators[ft.RevSawtooth]),Object(v.a)(e,ft.Sine,O.oscillators[ft.Sine]),Object(v.a)(e,ft.Triangle,O.oscillators[ft.Triangle]),Object(v.a)(e,ft.Pulse,O.oscillators[ft.Pulse]),e))}),[O,t,u]),Object(a.useEffect)((function(){if(O){var e;switch(m){case it:e=4.995*Math.pow(2,d)+.005;break;case lt:e=49.9*Math.pow(2,d)+.1;break;case dt:default:e=4490*Math.pow(2,d)+10}O.frequencyControl.offset.value=e}}),[O,d,m]),o.a.createElement(ue,null,o.a.createElement("span",null,"LFO"),o.a.createElement(de,{marginTop:15},j.a(I.a,ot.a(4),st((function(e,n){return o.a.createElement(se,{key:e,column:1,row:n+1},o.a.createElement(Q,{label:"",portId:e,moduleId:t,portType:"output"}))})))(ft),o.a.createElement(se,{column:1,row:5},o.a.createElement(Q,{portId:[ft.Pulse],moduleId:t,portType:"output",label:o.a.createElement("img",{width:25,src:n(61),alt:"Pulse"}),labelPosition:J.BELOW})),j.a(I.a,ot.a(4),st((function(e,t){return[o.a.createElement(se,{key:e+"arrow",column:2,row:t+1},o.a.createElement(rt.a,{size:"xs",icon:"arrow-left"})),o.a.createElement(se,{key:e,column:3,row:t+1},o.a.createElement("img",{width:25,src:n(60)("./".concat(e.toLowerCase(),".svg")),alt:e}))]})))(ft),o.a.createElement(se,{column:"2/4",row:5},o.a.createElement($,{label:"Frequ.",min:-4,max:4,step:.001,value:d,width:30,height:30,onChange:s})),o.a.createElement(se,{column:"1/4",row:6},o.a.createElement(Ge,{value:m,onChange:b,options:[{value:it,label:"L"},{value:lt,label:"M"},{value:dt,label:"H"}]}),"Frequ.",o.a.createElement("br",null),"Range")))};pt.isBrowserSupported="undefined"!==typeof OscillatorNode&&"undefined"!==typeof ConstantSourceNode,pt.panelWidth=8,pt.title="\nLFO<br/>\nLow frequency oscillator<br/>\nProduces cyclical control voltages in a very wide range of frequencies.<br/>\nFive waveforms are available:<br/>\nsawtooth, inverted sawtooth, triangle, sine and square wave.\n";var mt,vt,bt,Ot=pt,ht={VCO:"VCO",STEREO_AUDIO_INTERFACE:"STEREO_AUDIO_INTERFACE",MONO_AUDIO_INTERFACE:"MONO_AUDIO_INTERFACE",KEYBOARD:"KEYBOARD",ADSR:"ADSR",VCA:"VCA",VCF_LOW_PASS:"VCF_LOW_ASS",MULTIPLES:"MULTIPLES",LFO:"LFO"},Et=O.a(h.a(1))(ht),gt=function(e){var t=e.type,n=e.id,a={id:(void 0===n?void 0:n)||"".concat(t).concat(Et[t]),type:t};switch(t){case ht.VCO:a.Module=be;break;case ht.STEREO_AUDIO_INTERFACE:a.Module=Ee;break;case ht.MONO_AUDIO_INTERFACE:a.Module=je;break;case ht.KEYBOARD:a.Module=ze;break;case ht.ADSR:a.Module=Je;break;case ht.VCF_LOW_PASS:a.Module=et;break;case ht.VCA:a.Module=$e;break;case ht.MULTIPLES:a.Module=nt;break;case ht.LFO:a.Module=Ot;break;default:throw new Error("Cannot create module of type: ".concat(t))}return a.Module.isBrowserSupported?(a.width=16*a.Module.panelWidth,a.title=a.Module.title||t,Et[t]++,a):null},jt=n(165),It=n(166),wt=n(167),yt=n(183),Ct=n(184),St=n(168),Tt=n(181),xt=n(169),At=n(170),Mt=n(171),Pt=n(70),Rt=n(72),kt=n(172),Vt=n(69),Dt=n(191),Lt=n(173),_t=n(174),Gt=jt.a((function(e,t){var n=e.moduleId,a=e.portId;return It.a(wt.a(yt.a(z.a),[n,a]),j.a(y.a([n,a]),(function(e){return Ct.a([e.moduleId,e.portId],t)})))(t)})),Nt=Object(b.a)((mt={},Object(v.a)(mt,"ADD_MODULE",(function(e,t){var n=t.module,a=n.type,o=n.id,r=n.rackId,c=void 0===r?0:r,u=n.left,i=gt({type:a,id:o});return i?(i.left=u||function(e,t){for(var n=j.a(F.a,It.a(St.a(W.a({left:20})),Tt.a([{left:20,width:0}])),xt.a(te.a("left")))(e),a=0;a<n.length;a++){var o=n[a];if(a===n.length-1||n[a+1].left-o.left-o.width>=t)return o.left+o.width}}(e.modules,i.width),i.rackId=c,At.a({audioContextInitiliazed:Mt.a,modules:Pt.a(i.id,i),connections:Pt.a(i.id,{}),maxLeft:Rt.a(i.width)})(e)):(window.alert("Your browser doesn't support this module: ".concat(a)),e)})),Object(v.a)(mt,"REGISTER_INPUTS",(function(e,t){var n=t.id,a=t.inputs;return At.a({modules:At.a(Object(v.a)({},n,Pt.a("inputs",a)))})(e)})),Object(v.a)(mt,"REGISTER_OUTPUTS",(function(e,t){var n=t.id,a=t.outputs;return At.a({modules:At.a(Object(v.a)({},n,(function(e){return kt.a((function(e,t){"function"===typeof e&&Object.defineProperty(a,t,{get:e})}))(a),Object(m.a)({},e,{outputs:a})})))})(e)})),Object(v.a)(mt,"CONNECT_MODULES",(function(e,t){var n,a=t.input,o=t.output;return At.a({connections:j.a(Gt(o),Gt(a),At.a((n={},Object(v.a)(n,a.moduleId,Pt.a(a.portId,{moduleId:o.moduleId,portId:o.portId,counter:0,output:!0})),Object(v.a)(n,o.moduleId,Pt.a(o.portId,{moduleId:a.moduleId,portId:a.portId,counter:0})),n)))})(e)})),Object(v.a)(mt,"DISCONNECT_MODULE",(function(e,t){var n=t.port;return At.a({connections:j.a(Gt(n),At.a(Object(v.a)({},n.moduleId,Vt.a(n.portId))))})(e)})),Object(v.a)(mt,"SET_STARTING_PORT",(function(e,t){var n=t.port;return At.a({startingPort:h.a(n)})(e)})),Object(v.a)(mt,"UNSET_STARTING_PORT",(function(e){return At.a({startingPort:h.a(null)})(e)})),Object(v.a)(mt,"MOVE_MODULE",(function(e,t){var n=t.moduleId,a=t.x,o=t.rackId,r=e.modules[n].left,c=e.modules[n].width,u=r+20*Math.floor((a-r)/20),i=u+c;return i>window.innerWidth||j.a(F.a,Dt.a((function(e){var t=e.id,a=e.left,r=e.width,c=e.rackId,l=a+r;return t!==n&&o===c&&(a>=u&&a<i||a<u&&l>u||a===u&&l===i)})))(e.modules)?e:At.a({modules:Object(v.a)({},n,{left:h.a(u),rackId:h.a(o)}),connections:Object(v.a)({},n,O.a(At.a({counter:Lt.a}))),maxLeft:_t.a(u+e.modules[n].width)})(e)})),Object(v.a)(mt,"REMOVE_MODULE",(function(e,t){var n=t.moduleId,a=e.modules[n];return At.a({modules:Vt.a(n),maxLeft:function(e){return a.left+a.width===e?a.left:e}})(e)})),mt),{audioContextInitiliazed:!1,modules:{},connections:{},startingPort:null,maxLeft:20,racks:2}),Bt=n(192),Ft=n(175),Ut=n(71),Wt=Object(b.a)((vt={},Object(v.a)(vt,"ADD_CABLE",(function(e,t){var n=t.portId,a=t.fromPoint,o=t.color;return At.a({cables:Pt.a(n,{portId:n,fromPoint:a,toPoint:a,color:o})})(e)})),Object(v.a)(vt,"MODIFY_CABLE",(function(e,t){var n=t.portId,a=t.fromPoint,o=t.toPoint,r=t.toPortId;return At.a({cables:At.a(Object(v.a)({},n,Bt.a(Ft.a,Ut.a(z.a,{fromPoint:a,toPoint:o,toPortId:r}))))})(e)})),Object(v.a)(vt,"REMOVE_CABLE",(function(e,t){var n=t.portId;return At.a({cables:Vt.a(n)})(e)})),Object(v.a)(vt,"CHANGE_OVER_PORT",(function(e,t){var n=t.portId;return Object(m.a)({},e,{overPort:n})})),vt),{cables:{},overPort:null}),zt=function(e){return function(t){return Object(m.a)({},t,{isDirty:e})}},qt=Object(b.a)((bt={},Object(v.a)(bt,"LOAD_PRESET_START",(function(e){return Object(m.a)({},e,{presetLoading:!0})})),Object(v.a)(bt,"LOAD_PRESET_FINISH",(function(e){return Object(m.a)({},zt(!1)(e),{presetLoading:!1})})),Object(v.a)(bt,"REMOVE_MODULE",zt(!0)),Object(v.a)(bt,"ADD_MODULE",zt(!0)),Object(v.a)(bt,"REMOVE_CABLE",zt(!0)),Object(v.a)(bt,"ADD_CABLE",zt(!0)),bt),{presetLoading:!1,isDirty:!1}),Ht=Object(f.c)({modules:Nt,cables:Wt,rack:qt}),Yt=n(176),Kt=n(177),Xt=n(193),Jt=n(182),Qt=function(e){var t=e.getState;return function(e){return function(n){switch(n.type){case"CONNECT_MODULES":var a=t().modules,o=a.modules,r=a.connections,c=y.a([n.input.moduleId,"inputs",n.input.portId])(o),u=y.a([n.output.moduleId,"outputs",n.output.portId])(o);j.a(y.a([n.output.moduleId,n.output.portId]),Yt.a(z.a,j.a((function(e){var t=e.moduleId,n=e.portId;return y.a([t,"inputs",n])(o)}),(function(e){return e.disconnect(u)}))))(r),j.a(y.a([n.input.moduleId,n.input.portId]),Yt.a(z.a,j.a((function(e){var t=e.moduleId,n=e.portId;return y.a([t,"outputs",n])(o)}),(function(e){return c.disconnect(e)}))))(r),c&&u&&c.connect(u);break;case"DISCONNECT_MODULE":var i=t().modules,l=i.modules,d=i.connections,s=y.a([n.port.moduleId,"inputs",n.port.portId])(l);if(s)j.a(y.a([n.port.moduleId,n.port.portId]),(function(e){var t=e.moduleId,n=e.portId;return y.a([t,"outputs",n])(l)}),(function(e){return s.disconnect(e)}))(d);else{var f=y.a([n.port.moduleId,"outputs",n.port.portId])(l);j.a(y.a([n.port.moduleId,n.port.portId]),(function(e){var t=e.moduleId,n=e.portId;return y.a([t,"inputs",n])(l)}),(function(e){return e.disconnect(f)}))(d)}break;case"SAVE_PRESET":var p=t().modules,m=p.modules,v=p.connections,b={modules:j.a(O.a(Kt.a(["id","type","left","rackId"])),F.a)(m),connections:j.a(Ut.a(Xt.a),kt.a((function(e,t){return j.a(w.a(W.a({output:!0})),kt.a((function(e,n){var a=e.moduleId,o=e.portId;return{input:{moduleId:t,portId:n},output:{portId:o,moduleId:a}}})),F.a)(e)})),F.a,Ut.a(Xt.a),Jt.a)(v)};localStorage.setItem("preset",JSON.stringify(b))}return e(n)}}},$t=[p.a,Qt],Zt=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__(f.a.apply(void 0,$t)):f.a.apply(void 0,$t),en=Object(f.d)(Ht,Zt),tn=n(195),nn=n(77);function an(){var e=Object(Z.a)(["\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    z-index: 99;\n"]);return an=function(){return e},e}function on(){var e=Object(Z.a)(["\n    flex: 1;\n    position: relative;\n"]);return on=function(){return e},e}function rn(){var e=Object(Z.a)(["\n    visibility: hidden;\n    color: gray;\n    cursor: pointer;\n\n    &:hover {\n        color: black;\n    }\n\n    ",":hover & {\n        visibility: ",";\n    }\n"]);return rn=function(){return e},e}function cn(){var e=Object(Z.a)(["\n    display: flex;\n    flex-direction: column;\n    background: #E8E8E8;\n    border: black 0.2px solid;\n    position: ",";\n    height: 100%;\n    user-select: none;\n    width: ","px;\n    height: ","px;\n    left: ","px;\n    top: ","px;\n    cursor: ",";\n"]);return cn=function(){return e},e}function un(){var e=Object(Z.a)(["\n    display: flex;\n    justify-content: space-between;\n    margin: -2px 0;\n"]);return un=function(){return e},e}var ln=function(){return o.a.createElement("img",{alt:"screw",src:n(152),height:14,width:14,style:{margin:5}})},dn=ee.b.div(un()),sn=function(e){var t=e.children;return o.a.createElement(dn,null,o.a.createElement(ln,null),t,o.a.createElement(ln,null))},fn=ee.b.div(cn(),(function(e){return e.viewMode?"relative":"absolute"}),Object(te.a)("width"),Object(te.a)("height"),Object(te.a)("left"),Object(te.a)("top"),(function(e){var t=e.viewMode,n=e.dragging;return t?"pointer":n?"grabbing":"grab"})),pn=ee.b.span(rn(),fn,(function(e){return e.viewMode?"hidden":"visible"})),mn=ee.b.div(on()),vn=ee.b.div(an()),bn=function(e){var t=e.children,n=e.setDragging,r=e.moduleId,c=e.viewMode,u=X(B),i=Object(a.useCallback)((function(e){e.stopPropagation(),e.preventDefault()}),[]);return o.a.createElement(fn,Object.assign({},e,{onMouseDown:function(){return!c&&n(!0)},onMouseUp:function(){return!c&&n(!1)}}),o.a.createElement(sn,null,o.a.createElement(pn,{viewMode:c,onClick:function(){return u(r)},onMouseDown:i},o.a.createElement(rt.a,{size:"xs",icon:"trash"}))),o.a.createElement(mn,null,c&&o.a.createElement(vn,null),t),o.a.createElement(sn,null))};function On(){var e=Object(Z.a)(["\n    /* width: 100px; */\n    &.show {\n        opacity: 1;\n    }\n\n    .multi-line {\n        text-align: left;\n    }\n"]);return On=function(){return e},e}function hn(){var e=Object(Z.a)(["\n    height: 370px;\n    border-style: solid;\n    border-color: #c9c9c9;\n    transform: scale(0.7);\n\n    &:hover {\n        border-color: white;\n    }\n"]);return hn=function(){return e},e}function En(){var e=Object(Z.a)(["\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    z-index: 99;\n    background-color: rgba(0,0,0,0.4);\n    display: flex;\n    justify-content: center;\n    padding-top: 20px;\n"]);return En=function(){return e},e}var gn=ee.b.div(En()),jn=ee.b.div(hn()),In=Object(ee.b)(nn.a)(On()),wn=function(e){var t=e.onClose,n=X((function(e){return R({type:e})})),r=Object(a.useCallback)((function(e,t){e.stopPropagation(),e.preventDefault(),n(t)}),[n]);return o.a.createElement(gn,{onClick:t},Object(j.a)(F.a,Object(O.a)((function(e){var t=gt({type:e}),n=t.width,a=t.title,c=t.Module;return o.a.createElement(jn,{"data-tip":a,key:e,onClick:function(t){return r(t,e)}},o.a.createElement(bn,{viewMode:!0,width:n,height:370},o.a.createElement(c,{viewMode:!0})))})))(ht),o.a.createElement(In,{place:"right",multiline:!0}))},yn=function(e,t){var n=e.y>t.y?e:t,a=e.y<t.y?e:t,o=.1*Math.abs(t.x-e.x)+Math.abs(e.y-t.y)/.4,r=.5+Math.log(1+Math.abs((t.y-e.y)/(t.x-e.x)))/(3*Math.log(2));r=n.x<a.x?1-r:r;var c=(e.x<t.x?1:-1)*r*Math.abs(e.x-t.x)||e.x;return"".concat(c," ").concat(o)},Cn=function(e){var t=e.fromPoint,n=e.toPoint,a=e.color,r=e.overPort,c=e.portId,u=e.toPortId;return o.a.createElement("path",{d:"M".concat(t.x," ").concat(t.y," q ").concat(yn(t,n)," ").concat(n.x-t.x," ").concat(n.y-t.y),opacity:r===c||r===u?.9:.6,stroke:a,fill:"transparent",strokeWidth:6})},Sn=function(e){var t=e.scrollLeft,n=e.height,a=e.scrollTop,r=Object(s.c)(j.a(y.a(["cables","cables"]),F.a)),c=Object(s.c)(y.a(["cables","overPort"]));return o.a.createElement("svg",{style:{position:"fixed",left:-t,top:-a,width:"calc(100% + ".concat(t,"px)"),height:n,pointerEvents:"none"}},r.map((function(e){return o.a.createElement(Cn,Object.assign({key:e.portId},e,{overPort:c}))})))},Tn=n(75),xn={Basic:{modules:[{type:ht.KEYBOARD,id:"KEYBOARD1"},{type:ht.VCO,id:"VCO1"},{type:ht.VCF_LOW_PASS,id:"VCF1"},{type:ht.ADSR,id:"ADSR1"},{type:ht.VCA,id:"VCA1"},{type:ht.MONO_AUDIO_INTERFACE,id:"MONO_AUDIO_INTERFACE1"}],connections:[{input:{moduleId:"VCO1",portId:"CV1"},output:{moduleId:"KEYBOARD1",portId:"CV"}},{input:{moduleId:"VCF1",portId:"In"},output:{moduleId:"VCO1",portId:"Sine"}},{input:{moduleId:"ADSR1",portId:"Gate"},output:{moduleId:"KEYBOARD1",portId:"Gate"}},{input:{moduleId:"VCA1",portId:"AudioIn1"},output:{moduleId:"VCF1",portId:"Out"}},{input:{moduleId:"VCA1",portId:"CV1"},output:{moduleId:"ADSR1",portId:"Out1"}},{input:{moduleId:"MONO_AUDIO_INTERFACE1",portId:"In"},output:{moduleId:"VCA1",portId:"AudioOut"}}]}},An=n(194),Mn=n(80),Pn=function(){return{type:"SAVE_PRESET"}},Rn=jt.a((function(e,t){var n=t.input,a=t.output;e(k(t));var o="".concat(n.moduleId,"-").concat(n.portId),r=document.getElementById(o).getBoundingClientRect();e(x({portId:o,color:K()({luminosity:"dark"}),fromPoint:{x:r.x+r.width/2,y:r.y+r.height/2}}));var c=document.getElementById("".concat(a.moduleId,"-").concat(a.portId)).getBoundingClientRect();e(A({portId:o,toPortId:"".concat(a.moduleId,"-").concat(a.portId),toPoint:{x:c.x+c.width/2,y:c.y+c.height/2}}))})),kn=function(e){return function(t,n){t({type:"LOAD_PRESET_START"}),t((function(e,t){j.a(I.a,O.a((function(t){return e(B(t))})))(t().modules.modules),e({type:"REMOVE_ALL_MODULES"})})),setTimeout(Vn(t,n,e),10)}},Vn=function e(t,n,a){return function(){Xt.a(n().modules.modules)?(C.a((function(e){return t(R(e))}))(a.modules),setTimeout(Dn(t,n,a),10)):setTimeout(e(t,n,a),10)}},Dn=function e(t,n,a){return function(){var o=O.a(te.a("id"),n().modules.modules),r=O.a(te.a("id"),a.modules);Xt.a(An.a(o,r))?(C.a(Rn(t))(a.connections),setTimeout(Ln(t,n,a.connections),50)):setTimeout(e(t,n,a),10)}},Ln=function e(t,n,a){return function(){var o=n().modules.connections;Mn.a((function(e){var t=o[e.input.moduleId];if(!t)return!1;var n=t[e.input.portId];return n&&n.moduleId===e.output.moduleId&&n.portId===e.output.portId}),a)?t({type:"LOAD_PRESET_FINISH"}):setTimeout(e(t,n,a),10)}};function _n(){var e=Object(Z.a)(["\nfont-size: 25px;\nmargin-right: 20px;\ncolor: #e8e8e8;\ncursor: pointer;\n\n&:hover {\n    color: white;        \n}\n"]);return _n=function(){return e},e}var Gn=Object(ee.b)(rt.a)(_n());function Nn(){var e=Object(Z.a)(["\n    flex: 1;\n    max-width: 200px;\n"]);return Nn=function(){return e},e}function Bn(){var e=Object(Z.a)(["\n    display: flex;\n    flex: 1;\n    align-items: center;\n\n    > * {\n        margin: 0 10px;\n    }\n"]);return Bn=function(){return e},e}for(var Fn=ee.b.div(Bn()),Un=Object(ee.b)(Tn.a)(Nn()),Wn=function(){var e=Object(s.c)(y.a(["rack","isDirty"])),t=Object(s.c)(y.a(["rack","presetLoading"])),n=X(kn),r=X(Pn),c=Object(a.useState)(""),u=Object(E.a)(c,2),i=(u[0],u[1]);Object(a.useEffect)((function(){!t&&e&&i("")}),[e,t]);var l=Object(a.useMemo)((function(){return j.a(I.a,O.a((function(e){return{value:e,label:e}})))(xn)}),[]),d=Object(a.useCallback)((function(e){var t=e.value;i(t),n(xn[t])}),[n]),f=Object(a.useCallback)((function(){var e=localStorage.getItem("preset");e&&n(JSON.parse(e))}),[n]);return o.a.createElement(Fn,null,o.a.createElement(Gn,{icon:"file-download",title:"Save",onClick:r}),o.a.createElement(Gn,{icon:"file-upload",title:"Load",onClick:f}),o.a.createElement(Un,{options:l,onChange:d,placeholder:"Select Preset"}))},zn=(n(153),new Float32Array(256)),qn=0;qn<128;qn++)zn[qn]=-1,zn[qn+128]=1;var Hn=new Float32Array(2);function Yn(){var e=this.createOscillator();e.type="sawtooth";var t=this.createWaveShaper();t.curve=zn,e.connect(t);var n=this.createGain();n.gain.value=0,e.width=n.gain,e.widthGain=n,n.connect(t);var a=this.createWaveShaper();return a.curve=Hn,e.connect(a),a.connect(n),e.connect=function(){return t.connect.apply(t,arguments),e},e.disconnect=function(){return t.disconnect.apply(t,arguments),e},e}Hn[0]=1,Hn[1]=1;var Kn=n(178),Xn=n(179),Jn=Object(Kn.a)(Xn.a,(function(e,t){for(var n=new Float32Array(8192),a=0;a<8192;a++){var o=a/8191*4-2;n[a]=e*Math.pow(t,o)}return n}));function Qn(e,t){var n=this.createConstantSource();n.volt=n.offset;var a=this.createWaveShaper(),o=this.createGain();return a.curve=Jn(e,t),o.gain.value=1/t,n.connect(o).connect(a),n.connect=function(){return a.connect.apply(a,arguments),o},n.disconnect=function(){return a.disconnect.apply(a,arguments),o},n}var $n=n(56);function Zn(){var e=this.createScriptProcessor(256,1,1);return e.connect(this.destination),e.gateOn=!1,e.onaudioprocess=function(t){var n=t.inputBuffer.getChannelData(0);if(Math.max.apply(Math,Object($n.a)(n))>=.99&&!e.gateOn)e.gateOn=!0,e.gateChange&&e.gateChange(1);else{var a=Math.min.apply(Math,Object($n.a)(n));(0===a||a<=-.99)&&e.gateOn&&(e.gateOn=!1,e.gateChange&&e.gateChange(0))}},e}var ea=n(74),ta=n.n(ea);function na(){var e=Object(Z.a)(["\n    display: flex;\n    flex-direction: row;\n    background-color: #353535;\n    align-items: center;\n    height: 50px;\n    padding-left: 30px;\n"]);return na=function(){return e},e}function aa(){var e=Object(Z.a)(["\n    width: ",";\n    position: relative;\n    user-select: none;\n    background-size: contain;\n    background-image: url(",");\n    height: ","px;    \n"]);return aa=function(){return e},e}function oa(){var e=Object(Z.a)(["\n    overflow-x: scroll;\n    position: relative;\n"]);return oa=function(){return e},e}function ra(){var e=Object(Z.a)(["\n    position: relative;\n"]);return ra=function(){return e},e}var ca=ee.b.div(ra()),ua=ee.b.div(oa()),ia=ee.b.div(aa(),(function(e){var t=e.scrollLeft;return"calc(100% + ".concat(t,"px)")}),ta.a,370),la=ee.b.div(na()),da=function(){var e=Object(s.c)(j.a(y.a(["modules","modules"]),F.a)),t=Object(s.c)(y.a(["modules","racks"])),n=Object(s.c)(y.a(["modules","startingPort"])),r=Object(s.c)(y.a(["modules","audioContextInitiliazed"])),c=X(G),u=X(N),i=X(A),l=X(M),d=Object(a.useState)(null),f=Object(E.a)(d,2),p=f[0],m=f[1],v=Object(a.useState)(0),b=Object(E.a)(v,2),h=b[0],g=b[1],I=Object(a.useState)(0),w=Object(E.a)(I,2),C=w[0],S=w[1],T=Object(a.useState)(0),x=Object(E.a)(T,2),P=x[0],R=x[1],k=Object(a.useState)(null),V=Object(E.a)(k,2),D=V[0],L=V[1],_=Object(a.useState)(!1),B=Object(E.a)(_,2),U=B[0],W=B[1];Object(a.useEffect)((function(){window.onscroll=function(e){return S(window.scrollY)}}),[]),Object(a.useEffect)((function(){if(!D){var e=new(window.AudioContext||window.webkitAudioContext);e.createPulseOscillator=Yn,e.createVoltToHzConverter=Qn,e.createGate=Zn,L(e)}}),[D,r]);var z=Object(a.useCallback)((function(e){n&&i({portId:"".concat(n.moduleId,"-").concat(n.portId),toPoint:{x:e.clientX,y:e.clientY+C}})}),[i,n,C]),q=Object(a.useCallback)((function(e){p&&u(p,e.clientX,P)}),[p,u,P]),H=Object(a.useCallback)((function(){n&&(l("".concat(n.moduleId,"-").concat(n.portId)),c())}),[c,l,n]),Y=Object(a.useCallback)((function(e){z(e),q(e)}),[z,q]),K=Object(a.useCallback)((function(e){return function(t){m(t?e:null)}}),[]),J=Object(a.useCallback)((function(e){g(e.target.scrollLeft)}),[]);return o.a.createElement(ca,{onMouseUp:H,onMouseMove:Y,onScroll:J},U&&o.a.createElement(wn,{onClose:function(){return W(!1)}}),o.a.createElement(la,null,o.a.createElement(Gn,{icon:"plus-circle",title:"Add Module",onClick:function(){return W(!0)}}),o.a.createElement(Wn,null)),o.a.createElement(ua,null,j.a(tn.a(0),O.a((function(e){return o.a.createElement(ia,{key:e,scrollLeft:h,onMouseEnter:function(){return R(e)}})})))(t),D&&e.map((function(e){var t=e.Module,n=e.width,a=e.left,r=e.id,c=e.rackId;return o.a.createElement(bn,{key:r,top:370*c,moduleId:r,setDragging:K(r),dragging:r===p,width:n,height:370,left:a},o.a.createElement(t,{id:r,audioContext:D}))}))),o.a.createElement(Sn,{scrollLeft:h,scrollTop:C,height:1.5*t*370}))},sa=n(25),fa=n(35);n(154);sa.b.add(fa.e),sa.b.add(fa.a),sa.b.add(fa.d),sa.b.add(fa.c),sa.b.add(fa.b);var pa=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){return o.a.createElement(s.a,{store:en},o.a.createElement("div",{className:"App"},o.a.createElement(da,null)))}}]),n}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(pa,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},60:function(e,t,n){var a={"./pulse.svg":61,"./revsawtooth.svg":95,"./sawtooth.svg":96,"./sine.svg":97,"./triangle.svg":98};function o(e){var t=r(e);return n(t)}function r(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}o.keys=function(){return Object.keys(a)},o.resolve=r,e.exports=o,o.id=60},61:function(e,t,n){e.exports=n.p+"static/media/pulse.f9689bc2.svg"},74:function(e,t,n){e.exports=n.p+"static/media/rack_bg.cd50a535.svg"},81:function(e,t,n){e.exports=n(155)},86:function(e,t,n){},92:function(e,t,n){},93:function(e,t,n){e.exports=n.p+"static/media/port.1b33f6c1.svg"},94:function(e,t,n){e.exports=n.p+"static/media/knob.23f417df.svg"},95:function(e,t,n){e.exports=n.p+"static/media/revsawtooth.e22804aa.svg"},96:function(e,t,n){e.exports=n.p+"static/media/sawtooth.de511017.svg"},97:function(e,t,n){e.exports=n.p+"static/media/sine.e1994103.svg"},98:function(e,t,n){e.exports=n.p+"static/media/triangle.87d20148.svg"}},[[81,1,2]]]);
//# sourceMappingURL=main.82c7846f.chunk.js.map